{"ast":null,"code":"import React,{useEffect,useRef,useState,useCallback}from'react';import{init,dispose}from'klinecharts';import axios from'axios';import{Segmented,Spin,Typography,Space,Tabs,Card,InputNumber,Select,Tooltip,Table}from'antd';import{QuestionCircleOutlined}from'@ant-design/icons';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const{Text}=Typography;const KlineChart=_ref=>{let{indexId,height=400,onIntervalChange,refreshToken,onForecastUpdate}=_ref;const chartRef=useRef(null);const chartInstance=useRef(null);const[loading,setLoading]=useState(false);const[hasData,setHasData]=useState(false);const[interval,setInterval]=useState('1day');const[lastPrice,setLastPrice]=useState(null);const[prevClose,setPrevClose]=useState(null);const[lastOpen,setLastOpen]=useState(null);const[lastHigh,setLastHigh]=useState(null);const[lastLow,setLastLow]=useState(null);const[lastVol,setLastVol]=useState(null);const[lastTs,setLastTs]=useState(null);const[avgVol14,setAvgVol14]=useState(null);const[activeTab,setActiveTab]=useState('MA');const[dataList,setDataList]=useState([]);const[forecast,setForecast]=useState({});const[btMetrics,setBtMetrics]=useState(null);const[fMethod,setFMethod]=useState('linreg');const[fWindow,setFWindow]=useState(200);const[fAlpha,setFAlpha]=useState(0.3);const[fBeta,setFBeta]=useState(0.1);const[fUseLog,setFUseLog]=useState(true);const[fThreshPct,setFThreshPct]=useState(0);const[fCostPct,setFCostPct]=useState(0);const[earliestProfitDays,setEarliestProfitDays]=useState(null);const[earliestProfitTarget,setEarliestProfitTarget]=useState(null);const[earliestProfitPct,setEarliestProfitPct]=useState(null);const[bestEntryDay,setBestEntryDay]=useState(null);const[bestEntryDate,setBestEntryDate]=useState('');const[bestEntryPrice,setBestEntryPrice]=useState(null);const[curve,setCurve]=useState([]);// help moved to Help Center page\n// Initialize chart then load data once mounted\nuseEffect(()=>{if(chartRef.current&&!chartInstance.current){chartInstance.current=init(chartRef.current);// Apply light theme styles for cleaner visuals\ntry{chartInstance.current.setStyles({grid:{show:true,horizontal:{show:true,style:'solid',size:1,color:'#eceff3',dashedValue:[3,3]},vertical:{show:true,style:'solid',size:1,color:'#eceff3',dashedValue:[3,3]}},candle:{type:'candle_solid',bar:{compareRule:'previous_close',upColor:'#16a34a',downColor:'#ef4444',noChangeColor:'#64748b',upBorderColor:'#16a34a',downBorderColor:'#ef4444',noChangeBorderColor:'#64748b',upWickColor:'#16a34a',downWickColor:'#ef4444',noChangeWickColor:'#64748b'}},xAxis:{show:true,size:'auto',axisLine:{show:false,style:'solid',size:1,color:'#e2e8f0',dashedValue:[0,0]},tickLine:{show:false,style:'solid',size:1,color:'#e2e8f0',dashedValue:[0,0],length:3},tickText:{show:true,color:'#475569',weight:400,family:'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',size:10,marginStart:0,marginEnd:0}},yAxis:{show:true,size:'auto',axisLine:{show:false,style:'solid',size:1,color:'#e2e8f0',dashedValue:[0,0]},tickLine:{show:false,style:'solid',size:1,color:'#e2e8f0',dashedValue:[0,0],length:3},tickText:{show:true,color:'#475569',weight:400,family:'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',size:10,marginStart:0,marginEnd:0}},crosshair:{show:true,horizontal:{show:true,line:{show:true,style:'dashed',size:1,color:'#94a3b8',dashedValue:[2,3]},text:{show:true,color:'#0f172a',size:10,family:'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',weight:500,paddingLeft:6,paddingRight:6,paddingTop:2,paddingBottom:2,borderRadius:4,backgroundColor:'#f8fafc',borderStyle:'solid',borderDashedValue:[0,0],borderSize:1,borderColor:'#e2e8f0'}},vertical:{show:true,line:{show:true,style:'dashed',size:1,color:'#94a3b8',dashedValue:[2,3]},text:{show:true,color:'#0f172a',size:10,family:'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',weight:500,paddingLeft:6,paddingRight:6,paddingTop:2,paddingBottom:2,borderRadius:4,backgroundColor:'#f8fafc',borderStyle:'solid',borderDashedValue:[0,0],borderSize:1,borderColor:'#e2e8f0'}}},separator:{size:1,color:'#e2e8f0',fill:false,activeBackgroundColor:'#e5e7eb'}});// Default indicators: none at init; will attach based on active tab below\n}catch(e){// ignore style application errors to avoid breaking chart init\n}// Handle responsive resizing\nconst handleResize=()=>{if(chartInstance.current){chartInstance.current.resize();}};window.addEventListener('resize',handleResize);// Slightly tighter bars for a modern look\ntry{var _chartInstance$curren,_chartInstance$curren2;(_chartInstance$curren=chartInstance.current)===null||_chartInstance$curren===void 0?void 0:(_chartInstance$curren2=_chartInstance$curren.setBarSpace)===null||_chartInstance$curren2===void 0?void 0:_chartInstance$curren2.call(_chartInstance$curren,8);}catch(_unused){}return()=>{window.removeEventListener('resize',handleResize);};}return()=>{if(chartInstance.current&&chartRef.current){const chartElement=chartRef.current;dispose(chartElement);chartInstance.current=null;}};},[]);// First load after init and on changes\nuseEffect(()=>{if(indexId&&chartInstance.current){loadKlineData(interval);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[indexId,interval]);// Load kline data\nconst loadKlineData=useCallback(async selectedInterval=>{if(!chartInstance.current)return;setLoading(true);try{var _chartInstance$curren3,_chartInstance$curren4;// Import marketApiService dynamically to avoid circular imports\nconst{marketApiService}=await import('../services/marketApiService');const resp=await marketApiService.getKlineDataByIndex(indexId,selectedInterval);const points=Array.isArray(resp===null||resp===void 0?void 0:resp.data)?resp.data:[];if(!points.length){setHasData(false);chartInstance.current.applyNewData([]);return;}const chartData=points.map(p=>({timestamp:Number(p.t),open:p.o,high:p.h,low:p.l,close:p.c,volume:p.v}));// Clear existing data and add new data\nchartInstance.current.applyNewData(chartData);(_chartInstance$curren3=(_chartInstance$curren4=chartInstance.current).scrollToRealTime)===null||_chartInstance$curren3===void 0?void 0:_chartInstance$curren3.call(_chartInstance$curren4,0);setDataList(chartData);setHasData(true);// Update header metrics\nconst len=chartData.length;if(len>=2){const last=chartData[len-1];const prev=chartData[len-2];setLastPrice(last.close);setPrevClose(prev.close);setLastOpen(last.open);setLastHigh(last.high);setLastLow(last.low);setLastVol(last.volume);setLastTs(last.timestamp);const start=Math.max(0,len-14);const vols=chartData.slice(start,len).map(d=>d.volume);setAvgVol14(vols.length?vols.reduce((a,b)=>a+b,0)/vols.length:null);}else if(len===1){const last=chartData[0];setLastPrice(last.close);setPrevClose(last.close);setLastOpen(last.open);setLastHigh(last.high);setLastLow(last.low);setLastVol(last.volume);setLastTs(last.timestamp);setAvgVol14(last.volume);}else{setLastPrice(null);setPrevClose(null);setLastOpen(null);setLastHigh(null);setLastLow(null);setLastVol(null);setLastTs(null);setAvgVol14(null);}// Update forecast from backend strategy\ntry{var _res$data,_minPrice,_minPrice2;const EXT_HORIZONS=Array.from({length:30},(_,i)=>i+1);const res=await axios.post('/forecast/run',{id:indexId,type:interval,horizons:EXT_HORIZONS,method:fMethod,window:fWindow,params:{alpha:fAlpha,beta:fBeta,use_log:fUseLog?1:0},data:chartData.map(d=>({t:String(d.timestamp),o:d.open,h:d.high,l:d.low,c:d.close,v:d.volume}))},{baseURL:'/api/v1'});const preds=((_res$data=res.data)===null||_res$data===void 0?void 0:_res$data.predictions)||{};const cur=chartData.length?chartData[chartData.length-1].close:null;const pVal=d=>{var _preds$d;return(_preds$d=preds[d])!==null&&_preds$d!==void 0?_preds$d:preds[String(d)];};const build=d=>{const p=pVal(d);if(p==null||cur==null)return undefined;const pct=cur?(p-cur)/cur*100:0;return{price:p,pct};};const forecastsObj={};[7,14,30].forEach(d=>{const v=build(d);if(v)forecastsObj[d]=v;});setForecast({d7:forecastsObj[7],d14:forecastsObj[14],d30:forecastsObj[30]});let earliest=null;let earliestTarget=null;let earliestPct=null;let minDay=null;let minPrice=null;const minGain=fThreshPct+fCostPct;const daily=[];if(cur!=null){for(const d of EXT_HORIZONS){const p=pVal(d);if(typeof p==='number'){if(minPrice==null||p<minPrice){minPrice=p;minDay=d;}const pct=(p-cur)/cur*100;const net=pct-fCostPct;const hit=pct>=minGain;daily.push({day:d,pct,netPct:net,hit});if(earliest==null&&pct>=minGain){earliest=d;earliestTarget=p;earliestPct=pct;}}}}setEarliestProfitDays(earliest);setEarliestProfitTarget(earliestTarget);setEarliestProfitPct(earliestPct);setBestEntryDay(minDay);if(lastTs&&minDay!=null){const dt=new Date(Number(lastTs)+minDay*24*60*60*1000);setBestEntryDate(dt.toLocaleDateString());}else{setBestEntryDate('');}setBestEntryPrice((_minPrice=minPrice)!==null&&_minPrice!==void 0?_minPrice:null);setCurve(daily);onForecastUpdate&&onForecastUpdate({currentPrice:cur,forecasts:forecastsObj,// @ts-ignore\nminGainPct:minGain,// @ts-ignore\nuseLog:fUseLog,earliestProfitDays:earliest,earliestProfitTarget:earliestTarget,earliestProfitPct:earliestPct,bestEntryDay:minDay,bestEntryPrice:(_minPrice2=minPrice)!==null&&_minPrice2!==void 0?_minPrice2:null});}catch(_unused2){}// Fetch backtest metrics (1..30 days)\ntry{var _res$data2;const EXT_HORIZONS=Array.from({length:30},(_,i)=>i+1);const res=await axios.post('/forecast/backtest',{id:indexId,type:interval,horizons:EXT_HORIZONS,method:fMethod,window:fWindow,step:5,params:{alpha:fAlpha,beta:fBeta,use_log:fUseLog?1:0},data:chartData.map(d=>({t:String(d.timestamp),o:d.open,h:d.high,l:d.low,c:d.close,v:d.volume}))},{baseURL:'/api/v1'});setBtMetrics(((_res$data2=res.data)===null||_res$data2===void 0?void 0:_res$data2.metrics)||null);}catch(_unused3){}}catch(err){console.error('K线数据加载错误:',err);setHasData(false);}finally{setLoading(false);}},[indexId]);// Fetch forecasts only when settings change\nuseEffect(()=>{const run=async()=>{if(!chartInstance.current||!dataList.length)return;try{var _res$data3,_dataList$close,_dataList,_minPrice3,_minPrice4;const EXT_HORIZONS=Array.from({length:30},(_,i)=>i+1);const res=await axios.post('/forecast/run',{id:indexId,type:interval,horizons:EXT_HORIZONS,method:fMethod,window:fWindow,params:{alpha:fAlpha,beta:fBeta,use_log:fUseLog?1:0},data:dataList.map(d=>({t:String(d.timestamp),o:d.open,h:d.high,l:d.low,c:d.close,v:d.volume}))},{baseURL:'/api/v1'});const preds=((_res$data3=res.data)===null||_res$data3===void 0?void 0:_res$data3.predictions)||{};const cur=(_dataList$close=(_dataList=dataList[dataList.length-1])===null||_dataList===void 0?void 0:_dataList.close)!==null&&_dataList$close!==void 0?_dataList$close:null;const pVal=d=>{var _preds$d2;return(_preds$d2=preds[d])!==null&&_preds$d2!==void 0?_preds$d2:preds[String(d)];};const build=d=>{const p=pVal(d);if(p==null||cur==null)return undefined;const pct=cur?(p-cur)/cur*100:0;return{price:p,pct};};const forecastsObj={};[7,14,30].forEach(d=>{const v=build(d);if(v)forecastsObj[d]=v;});setForecast({d7:forecastsObj[7],d14:forecastsObj[14],d30:forecastsObj[30]});let earliest=null;let earliestTarget=null;let earliestPct=null;let minDay=null;let minPrice=null;const minGain=fThreshPct+fCostPct;const daily=[];if(cur!=null){for(const d of EXT_HORIZONS){const p=pVal(d);if(typeof p==='number'){if(minPrice==null||p<minPrice){minPrice=p;minDay=d;}const pct=(p-cur)/cur*100;const net=pct-fCostPct;const hit=pct>=minGain;daily.push({day:d,pct,netPct:net,hit});if(earliest==null&&pct>=minGain){earliest=d;earliestTarget=p;earliestPct=pct;}}}}setEarliestProfitDays(earliest);setEarliestProfitTarget(earliestTarget);setEarliestProfitPct(earliestPct);setBestEntryDay(minDay);if(lastTs&&minDay!=null){const dt=new Date(Number(lastTs)+minDay*24*60*60*1000);setBestEntryDate(dt.toLocaleDateString());}else{setBestEntryDate('');}setBestEntryPrice((_minPrice3=minPrice)!==null&&_minPrice3!==void 0?_minPrice3:null);setCurve(daily);onForecastUpdate&&onForecastUpdate({currentPrice:cur,forecasts:forecastsObj,// @ts-ignore\nminGainPct:minGain,// @ts-ignore\nuseLog:fUseLog,earliestProfitDays:earliest,earliestProfitTarget:earliestTarget,earliestProfitPct:earliestPct,bestEntryDay:minDay,bestEntryPrice:(_minPrice4=minPrice)!==null&&_minPrice4!==void 0?_minPrice4:null});}catch(_unused4){}try{var _res$data4;const EXT_HORIZONS=Array.from({length:30},(_,i)=>i+1);const res=await axios.post('/forecast/backtest',{id:indexId,type:interval,horizons:EXT_HORIZONS,method:fMethod,window:fWindow,step:5,params:{alpha:fAlpha,beta:fBeta,use_log:fUseLog?1:0},data:dataList.map(d=>({t:String(d.timestamp),o:d.open,h:d.high,l:d.low,c:d.close,v:d.volume}))},{baseURL:'/api/v1'});setBtMetrics(((_res$data4=res.data)===null||_res$data4===void 0?void 0:_res$data4.metrics)||null);}catch(_unused5){}};run();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[fMethod,fWindow,fAlpha,fBeta]);// Manual refresh support\nuseEffect(()=>{if(indexId&&chartInstance.current){loadKlineData(interval);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[refreshToken]);const handleIntervalChange=newInterval=>{setInterval(newInterval);if(onIntervalChange){onIntervalChange(newInterval);}};// Compute change\nconst changeAbs=lastPrice!=null&&prevClose!=null?lastPrice-prevClose:null;const changePct=changeAbs!=null&&prevClose?changeAbs/prevClose*100:null;const up=(changeAbs!==null&&changeAbs!==void 0?changeAbs:0)>0;const down=(changeAbs!==null&&changeAbs!==void 0?changeAbs:0)<0;const formatNum=function(n){let digits=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;return n==null?'--':n.toFixed(digits);};const formatTS=ts=>ts==null?'':new Date(ts).toLocaleString();// Remove all known indicators\nconst removeAllIndicators=()=>{if(!chartInstance.current)return;const names=['MA','BOLL','MACD','VOL'];for(const name of names){// keep removing until none left\n// @ts-ignore\nwhile((_chartInstance$curren5=(_chartInstance$curren6=chartInstance.current).removeIndicator)!==null&&_chartInstance$curren5!==void 0&&_chartInstance$curren5.call(_chartInstance$curren6,{name})){var _chartInstance$curren5,_chartInstance$curren6;}// loop\n}};const applyIndicatorByTab=tab=>{var _chartInstance$curren7,_chartInstance$curren8,_chartInstance$curren9,_chartInstance$curren0,_chartInstance$curren1,_chartInstance$curren10;if(!chartInstance.current)return;removeAllIndicators();try{switch(tab){case'MA':(_chartInstance$curren7=(_chartInstance$curren8=chartInstance.current).overrideIndicator)===null||_chartInstance$curren7===void 0?void 0:_chartInstance$curren7.call(_chartInstance$curren8,{name:'MA',calcParams:[5,10,20]});chartInstance.current.createIndicator('MA',false);break;case'BOLL':chartInstance.current.createIndicator('BOLL',false);break;case'MACD':(_chartInstance$curren9=(_chartInstance$curren0=chartInstance.current).overrideIndicator)===null||_chartInstance$curren9===void 0?void 0:_chartInstance$curren9.call(_chartInstance$curren0,{name:'MACD',calcParams:[12,26,9]});chartInstance.current.createIndicator('MACD',false,{height:120});break;case'VOL':(_chartInstance$curren1=(_chartInstance$curren10=chartInstance.current).overrideIndicator)===null||_chartInstance$curren1===void 0?void 0:_chartInstance$curren1.call(_chartInstance$curren10,{name:'VOL',calcParams:[5,10]});chartInstance.current.createIndicator('VOL',false,{height:96});break;default:break;}}catch(_unused6){}};useEffect(()=>{applyIndicatorByTab(activeTab);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[activeTab,chartInstance.current]);return/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:12,display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(Space,{size:12,wrap:true,children:[/*#__PURE__*/_jsx(Text,{strong:true,style:{color:'#334155'},children:\"\\u6307\\u6570ID: \".concat(indexId)}),/*#__PURE__*/_jsx(Segmented,{size:\"small\",value:interval,options:[{label:'1小时',value:'1hour'},{label:'4小时',value:'4hour'},{label:'日线',value:'1day'},{label:'周线',value:'7day'}],onChange:val=>handleIntervalChange(val)})]}),/*#__PURE__*/_jsxs(Space,{size:10,wrap:true,children:[lastPrice!=null&&/*#__PURE__*/_jsxs(Text,{style:{color:up?'#2ECB7A':down?'#F64E4E':'#cbd5e1',fontWeight:600},children:[formatNum(lastPrice),\" \",changeAbs!=null&&changePct!=null&&(up?'+':'')+\"\".concat(formatNum(changeAbs),\" (\").concat(formatNum(changePct),\"%)\")]}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{color:'#475569'},children:[\"O \",formatNum(lastOpen)]}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{color:'#475569'},children:[\"H \",formatNum(lastHigh)]}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{color:'#475569'},children:[\"L \",formatNum(lastLow)]}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{color:'#475569'},children:[\"C \",formatNum(lastPrice)]}),/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{color:'#64748b'},children:[\"\\u91CF \",formatNum(lastVol,0),avgVol14!=null?\" / \\u5747\\u91CF14 \".concat(formatNum(avgVol14,0)):'']}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{color:'#94a3b8'},children:formatTS(lastTs)}),loading&&/*#__PURE__*/_jsx(Spin,{size:\"small\"})]})]}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(Card,{size:\"small\",bordered:true,style:{borderRadius:8},children:/*#__PURE__*/_jsxs(Space,{size:24,wrap:true,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"7\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d7?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d7.pct>0?'#16a34a':forecast.d7.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d7.price),\" (\",formatNum(forecast.d7.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"14\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d14?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d14.pct>0?'#16a34a':forecast.d14.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d14.price),\" (\",formatNum(forecast.d14.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"30\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d30?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d30.pct>0?'#16a34a':forecast.d30.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d30.price),\" (\",formatNum(forecast.d30.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u6700\\u65E9\\u76C8\\u5229\\u5929\\u6570\"}),/*#__PURE__*/_jsx(\"div\",{children:earliestProfitDays!=null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Text,{style:{color:'#334155'},children:[earliestProfitDays,\" \\u5929\"]}),earliestProfitTarget!=null&&earliestProfitPct!=null&&/*#__PURE__*/_jsxs(Text,{style:{marginLeft:8,color:earliestProfitPct>0?'#16a34a':earliestProfitPct<0?'#ef4444':'#334155'},children:[\"\\u76EE\\u6807\\u4EF7 \",formatNum(earliestProfitTarget),\" (\",formatNum(earliestProfitPct),\"%)\"]})]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6682\\u65E0\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u6700\\u4F73\\u5165\\u624B\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"div\",{children:bestEntryDay!=null&&bestEntryPrice!=null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Text,{style:{color:'#334155'},children:bestEntryDate||\"\".concat(bestEntryDay,\" \\u5929\\u540E\")}),/*#__PURE__*/_jsxs(Text,{style:{marginLeft:8,color:'#334155'},children:[\"\\u9884\\u6D4B\\u4EF7 \",formatNum(bestEntryPrice)]})]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6682\\u65E0\"})})]})]})})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(Card,{size:\"small\",bordered:true,style:{borderRadius:8},title:\"\\u7D2F\\u8BA1\\u6536\\u76CA\\uFF081~30\\u5929\\uFF09\",children:curve.length?/*#__PURE__*/_jsx(Table,{size:\"small\",pagination:false,rowKey:r=>String(r.day),columns:[{title:'天数',dataIndex:'day',width:60},{title:'预测%',dataIndex:'pct',width:100,render:v=>\"\".concat(formatNum(v,2))},{title:'净收益%',dataIndex:'netPct',width:100,render:v=>\"\".concat(formatNum(v,2))},{title:'达标',dataIndex:'hit',width:80,render:v=>v?'是':'否'}],dataSource:curve}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6682\\u65E0\\u6570\\u636E\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(Card,{size:\"small\",bordered:true,style:{borderRadius:8},title:\"\\u9884\\u6D4B\\u51C6\\u786E\\u7387\\u56DE\\u6EAF\\uFF081~30\\u5929\\uFF09\",children:btMetrics?/*#__PURE__*/_jsx(Table,{size:\"small\",pagination:false,rowKey:r=>String(r.day),columns:[{title:'天数',dataIndex:'day',width:60},{title:'样本',dataIndex:'points',width:80},{title:'MAPE%',dataIndex:'mape',width:100},{title:'MAE',dataIndex:'mae',width:100},{title:'RMSE',dataIndex:'rmse',width:100},{title:'命中率%',dataIndex:'hit',width:100}],dataSource:Array.from({length:30},(_,i)=>i+1).map(d=>{var _m$points;const k=String(d);const m=btMetrics[k];return{day:d,points:(_m$points=m===null||m===void 0?void 0:m.points)!==null&&_m$points!==void 0?_m$points:0,mape:m?\"\".concat(formatNum(m.mape,2)):'--',mae:m?\"\".concat(formatNum(m.mae,2)):'--',rmse:m?\"\".concat(formatNum(m.rmse,2)):'--',hit:m?\"\".concat(formatNum(m.hit_rate,2)):'--'};})}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6B63\\u5728\\u52A0\\u8F7D\\u56DE\\u6EAF\\u6307\\u6807...\"})})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:8},children:/*#__PURE__*/_jsx(Tabs,{size:\"small\",activeKey:activeTab,onChange:setActiveTab,items:[{key:'MA',label:'MA 均线'},{key:'BOLL',label:'BOLL 布林带'},{key:'MACD',label:'MACD 动能'},{key:'VOL',label:'VOL 成交量'}]})}),/*#__PURE__*/_jsx(Card,{size:\"small\",style:{marginBottom:8,borderRadius:8},title:/*#__PURE__*/_jsxs(Space,{size:6,children:[\"\\u9884\\u6D4B\\u8BBE\\u7F6E\",/*#__PURE__*/_jsx(Tooltip,{overlayStyle:{maxWidth:420},title:/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:12,lineHeight:1.6},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u65B9\\u6CD5\\u9009\\u62E9\"}),\"\\uFF1Alinreg\\uFF08\\u7EBF\\u6027\\u8D8B\\u52BF\\uFF09\\uFF0CEMA\\uFF08\\u66F4\\u7075\\u654F\\uFF09\\uFF0CHolt\\uFF08\\u6C34\\u5E73+\\u8D8B\\u52BF\\uFF09\\u3002\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u7A97\\u53E3 window\"}),\"\\uFF1A\\u5EFA\\u8BAE 100\\u2013200\\uFF1B\\u8D8A\\u5927\\u8D8A\\u5E73\\u6ED1\\uFF0C\\u8D8A\\u5C0F\\u8D8A\\u654F\\u611F\\u3002\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u03B1\\uFF08EMA/Holt\\uFF09\"}),\"\\uFF1A\\u5EFA\\u8BAE 0.2\\u20130.5\\uFF1B\\u8D8A\\u5927\\u8D8A\\u770B\\u91CD\\u6700\\u65B0\\u6570\\u636E\\u3002\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u03B2\\uFF08Holt\\uFF09\"}),\"\\uFF1A\\u5EFA\\u8BAE 0.05\\u20130.2\\uFF1B\\u8D8A\\u5927\\u8D8B\\u52BF\\u66F4\\u65B0\\u66F4\\u5FEB\\u3002\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u56DE\\u6D4B step\"}),\"\\uFF1A\\u5EFA\\u8BAE 3\\u201310\\uFF1B\\u8D8A\\u5C0F\\u6837\\u672C\\u66F4\\u591A\\u4F46\\u8017\\u65F6\\u66F4\\u957F\\u3002\"]}),/*#__PURE__*/_jsx(\"div\",{style:{color:'#64748b'},children:\"\\u4EE5\\u4E0A\\u4E3A\\u7ECF\\u9A8C\\u503C\\uFF0C\\u4EC5\\u4F9B\\u91CF\\u5316\\u53C2\\u8003\\uFF0C\\u975E\\u6295\\u8D44\\u5EFA\\u8BAE\\u3002\"})]}),children:/*#__PURE__*/_jsx(QuestionCircleOutlined,{style:{color:'#64748b'}})})]}),children:/*#__PURE__*/_jsxs(Space,{size:12,wrap:true,children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u65B9\\u6CD5\"}),/*#__PURE__*/_jsx(Segmented,{size:\"small\",value:fMethod,onChange:v=>setFMethod(v),options:[{label:'线性回归',value:'linreg'},{label:'EMA',value:'ema'},{label:'Holt',value:'holt'}]}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u7A97\\u53E3\"}),/*#__PURE__*/_jsx(Select,{size:\"small\",value:fWindow,onChange:setFWindow,style:{width:120},options:[{value:50,label:'50'},{value:100,label:'100'},{value:200,label:'200'},{value:300,label:'300'}]}),(fMethod==='ema'||fMethod==='holt')&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u03B1\"}),/*#__PURE__*/_jsx(InputNumber,{size:\"small\",value:fAlpha,min:0.01,max:0.99,step:0.05,onChange:v=>setFAlpha(Number(v))})]}),fMethod==='holt'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u03B2\"}),/*#__PURE__*/_jsx(InputNumber,{size:\"small\",value:fBeta,min:0.0,max:0.99,step:0.05,onChange:v=>setFBeta(Number(v))})]}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u5BF9\\u6570\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(Segmented,{size:\"small\",value:fUseLog?'on':'off',onChange:v=>setFUseLog(v==='on'),options:[{label:'开',value:'on'},{label:'关',value:'off'}]}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u6536\\u76CA\\u9608\\u503C%\"}),/*#__PURE__*/_jsx(InputNumber,{size:\"small\",value:fThreshPct,step:0.5,onChange:v=>setFThreshPct(Number(v))}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u6210\\u672C%\"}),/*#__PURE__*/_jsx(InputNumber,{size:\"small\",value:fCostPct,step:0.5,onChange:v=>setFCostPct(Number(v))})]})}),/*#__PURE__*/_jsx(\"div\",{ref:chartRef,style:{width:'100%',height:\"\".concat(height,\"px\"),backgroundColor:'#ffffff',borderRadius:8,border:'1px solid #e2e8f0',position:'relative'}}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsx(Card,{size:\"small\",bordered:true,style:{borderRadius:8},children:/*#__PURE__*/_jsxs(Space,{size:24,wrap:true,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"7\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d7?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d7.pct>0?'#16a34a':forecast.d7.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d7.price),\" (\",formatNum(forecast.d7.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"14\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d14?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d14.pct>0?'#16a34a':forecast.d14.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d14.price),\" (\",formatNum(forecast.d14.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"30\\u5929\\u9884\\u6D4B\"}),/*#__PURE__*/_jsx(\"div\",{children:forecast.d30?/*#__PURE__*/_jsxs(Text,{style:{color:forecast.d30.pct>0?'#16a34a':forecast.d30.pct<0?'#ef4444':'#334155'},children:[formatNum(forecast.d30.price),\" (\",formatNum(forecast.d30.pct),\"%)\"]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u2014\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u6700\\u65E9\\u76C8\\u5229\\u5929\\u6570\"}),/*#__PURE__*/_jsx(\"div\",{children:earliestProfitDays!=null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Text,{style:{color:'#334155'},children:[earliestProfitDays,\" \\u5929\"]}),earliestProfitTarget!=null&&earliestProfitPct!=null&&/*#__PURE__*/_jsxs(Text,{style:{marginLeft:8,color:earliestProfitPct>0?'#16a34a':earliestProfitPct<0?'#ef4444':'#334155'},children:[\"\\u76EE\\u6807\\u4EF7 \",formatNum(earliestProfitTarget),\" (\",formatNum(earliestProfitPct),\"%)\"]})]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6682\\u65E0\"})})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"\\u6700\\u4F73\\u5165\\u624B\\u65E5\\u671F\"}),/*#__PURE__*/_jsx(\"div\",{children:bestEntryDay!=null&&bestEntryPrice!=null?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Text,{style:{color:'#334155'},children:bestEntryDate||\"\".concat(bestEntryDay,\" \\u5929\\u540E\")}),/*#__PURE__*/_jsxs(Text,{style:{marginLeft:8,color:'#334155'},children:[\"\\u9884\\u6D4B\\u4EF7 \",formatNum(bestEntryPrice)]})]}):/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"\\u6682\\u65E0\"})})]})]})})}),loading&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',backgroundColor:'rgba(0, 0, 0, 0.7)',borderRadius:'4px',padding:'20px',zIndex:1000},children:/*#__PURE__*/_jsx(Spin,{size:\"large\"})})]});};export default KlineChart;","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","init","dispose","axios","Segmented","Spin","Typography","Space","Tabs","Card","InputNumber","Select","Tooltip","Table","QuestionCircleOutlined","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Text","KlineChart","_ref","indexId","height","onIntervalChange","refreshToken","onForecastUpdate","chartRef","chartInstance","loading","setLoading","hasData","setHasData","interval","setInterval","lastPrice","setLastPrice","prevClose","setPrevClose","lastOpen","setLastOpen","lastHigh","setLastHigh","lastLow","setLastLow","lastVol","setLastVol","lastTs","setLastTs","avgVol14","setAvgVol14","activeTab","setActiveTab","dataList","setDataList","forecast","setForecast","btMetrics","setBtMetrics","fMethod","setFMethod","fWindow","setFWindow","fAlpha","setFAlpha","fBeta","setFBeta","fUseLog","setFUseLog","fThreshPct","setFThreshPct","fCostPct","setFCostPct","earliestProfitDays","setEarliestProfitDays","earliestProfitTarget","setEarliestProfitTarget","earliestProfitPct","setEarliestProfitPct","bestEntryDay","setBestEntryDay","bestEntryDate","setBestEntryDate","bestEntryPrice","setBestEntryPrice","curve","setCurve","current","setStyles","grid","show","horizontal","style","size","color","dashedValue","vertical","candle","type","bar","compareRule","upColor","downColor","noChangeColor","upBorderColor","downBorderColor","noChangeBorderColor","upWickColor","downWickColor","noChangeWickColor","xAxis","axisLine","tickLine","length","tickText","weight","family","marginStart","marginEnd","yAxis","crosshair","line","text","paddingLeft","paddingRight","paddingTop","paddingBottom","borderRadius","backgroundColor","borderStyle","borderDashedValue","borderSize","borderColor","separator","fill","activeBackgroundColor","e","handleResize","resize","window","addEventListener","_chartInstance$curren","_chartInstance$curren2","setBarSpace","call","_unused","removeEventListener","chartElement","loadKlineData","selectedInterval","_chartInstance$curren3","_chartInstance$curren4","marketApiService","resp","getKlineDataByIndex","points","Array","isArray","data","applyNewData","chartData","map","p","timestamp","Number","t","open","o","high","h","low","l","close","c","volume","v","scrollToRealTime","len","last","prev","start","Math","max","vols","slice","d","reduce","a","b","_res$data","_minPrice","_minPrice2","EXT_HORIZONS","from","_","i","res","post","id","horizons","method","params","alpha","beta","use_log","String","baseURL","preds","predictions","cur","pVal","_preds$d","build","undefined","pct","price","forecastsObj","forEach","d7","d14","d30","earliest","earliestTarget","earliestPct","minDay","minPrice","minGain","daily","net","hit","push","day","netPct","dt","Date","toLocaleDateString","currentPrice","forecasts","minGainPct","useLog","_unused2","_res$data2","step","metrics","_unused3","err","console","error","run","_res$data3","_dataList$close","_dataList","_minPrice3","_minPrice4","_preds$d2","_unused4","_res$data4","_unused5","handleIntervalChange","newInterval","changeAbs","changePct","up","down","formatNum","n","digits","arguments","toFixed","formatTS","ts","toLocaleString","removeAllIndicators","names","name","_chartInstance$curren5","_chartInstance$curren6","removeIndicator","applyIndicatorByTab","tab","_chartInstance$curren7","_chartInstance$curren8","_chartInstance$curren9","_chartInstance$curren0","_chartInstance$curren1","_chartInstance$curren10","overrideIndicator","calcParams","createIndicator","_unused6","position","children","marginBottom","display","justifyContent","alignItems","wrap","strong","concat","value","options","label","onChange","val","fontWeight","marginTop","bordered","marginLeft","title","pagination","rowKey","r","columns","dataIndex","width","render","dataSource","_m$points","k","m","mape","mae","rmse","hit_rate","activeKey","items","key","overlayStyle","maxWidth","fontSize","lineHeight","min","ref","border","top","left","transform","padding","zIndex"],"sources":["/Users/user/Downloads/csgoAuto/web/src/components/KlineChart.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { init, dispose, Chart } from 'klinecharts';\nimport axios from 'axios';\nimport { Segmented, Spin, Typography, Space, Button, Tabs, Card, InputNumber, Select, Tooltip, Table } from 'antd';\nimport { QuestionCircleOutlined } from '@ant-design/icons';\nimport { IndexKlineResponse, IndexKlineType } from '../services/marketApiService';\n\nconst { Text } = Typography;\n\ninterface KlineChartProps {\n  // 改为指数ID，以匹配 CSQAQ 指数K线接口\n  indexId: string;\n  height?: number;\n  onIntervalChange?: (interval: string) => void;\n  // 刷新触发器：父组件改变该值将强制重新拉取\n  refreshToken?: number;\n  onForecastUpdate?: (payload: {\n    currentPrice: number | null;\n    forecasts: Record<number, { price: number; pct: number }>;\n    earliestProfitDays: number | null;\n    earliestProfitTarget: number | null;\n    earliestProfitPct: number | null;\n    bestEntryDay: number | null;\n    bestEntryPrice: number | null;\n  }) => void;\n}\n\nconst KlineChart: React.FC<KlineChartProps> = ({\n  indexId,\n  height = 400,\n  onIntervalChange,\n  refreshToken,\n  onForecastUpdate\n}) => {\n  const chartRef = useRef<HTMLDivElement>(null);\n  const chartInstance = useRef<Chart | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [hasData, setHasData] = useState<boolean>(false);\n  const [interval, setInterval] = useState<IndexKlineType>('1day');\n  const [lastPrice, setLastPrice] = useState<number | null>(null);\n  const [prevClose, setPrevClose] = useState<number | null>(null);\n  const [lastOpen, setLastOpen] = useState<number | null>(null);\n  const [lastHigh, setLastHigh] = useState<number | null>(null);\n  const [lastLow, setLastLow] = useState<number | null>(null);\n  const [lastVol, setLastVol] = useState<number | null>(null);\n  const [lastTs, setLastTs] = useState<number | null>(null);\n  const [avgVol14, setAvgVol14] = useState<number | null>(null);\n  const [activeTab, setActiveTab] = useState<string>('MA');\n  const [dataList, setDataList] = useState<Array<{ timestamp: number; open: number; high: number; low: number; close: number; volume: number }>>([]);\n  const [forecast, setForecast] = useState<{ d7?: { price: number; pct: number }, d14?: { price: number; pct: number }, d30?: { price: number; pct: number } }>({});\n  const [btMetrics, setBtMetrics] = useState<Record<string, { points: number; mape: number; mae: number; rmse: number }> | null>(null);\n  const [fMethod, setFMethod] = useState<'linreg' | 'ema' | 'holt'>('linreg');\n  const [fWindow, setFWindow] = useState<number>(200);\n  const [fAlpha, setFAlpha] = useState<number>(0.3);\n  const [fBeta, setFBeta] = useState<number>(0.1);\n  const [fUseLog, setFUseLog] = useState<boolean>(true);\n  const [fThreshPct, setFThreshPct] = useState<number>(0);\n  const [fCostPct, setFCostPct] = useState<number>(0);\n  const [earliestProfitDays, setEarliestProfitDays] = useState<number | null>(null);\n  const [earliestProfitTarget, setEarliestProfitTarget] = useState<number | null>(null);\n  const [earliestProfitPct, setEarliestProfitPct] = useState<number | null>(null);\n  const [bestEntryDay, setBestEntryDay] = useState<number | null>(null);\n  const [bestEntryDate, setBestEntryDate] = useState<string>('');\n  const [bestEntryPrice, setBestEntryPrice] = useState<number | null>(null);\n  const [curve, setCurve] = useState<Array<{ day: number; pct: number; netPct: number; hit: boolean }>>([]);\n  // help moved to Help Center page\n\n  // Initialize chart then load data once mounted\n  useEffect(() => {\n    if (chartRef.current && !chartInstance.current) {\n      chartInstance.current = init(chartRef.current);\n\n      // Apply light theme styles for cleaner visuals\n      try {\n        chartInstance.current.setStyles({\n          grid: {\n            show: true,\n            horizontal: { show: true, style: 'solid', size: 1, color: '#eceff3', dashedValue: [3, 3] },\n            vertical: { show: true, style: 'solid', size: 1, color: '#eceff3', dashedValue: [3, 3] }\n          },\n          candle: {\n            type: 'candle_solid',\n            bar: {\n              compareRule: 'previous_close',\n              upColor: '#16a34a',\n              downColor: '#ef4444',\n              noChangeColor: '#64748b',\n              upBorderColor: '#16a34a',\n              downBorderColor: '#ef4444',\n              noChangeBorderColor: '#64748b',\n              upWickColor: '#16a34a',\n              downWickColor: '#ef4444',\n              noChangeWickColor: '#64748b'\n            }\n          },\n          xAxis: {\n            show: true,\n            size: 'auto',\n            axisLine: { show: false, style: 'solid', size: 1, color: '#e2e8f0', dashedValue: [0, 0] },\n            tickLine: { show: false, style: 'solid', size: 1, color: '#e2e8f0', dashedValue: [0, 0], length: 3 },\n            tickText: { show: true, color: '#475569', weight: 400, family: 'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial', size: 10, marginStart: 0, marginEnd: 0 }\n          },\n          yAxis: {\n            show: true,\n            size: 'auto',\n            axisLine: { show: false, style: 'solid', size: 1, color: '#e2e8f0', dashedValue: [0, 0] },\n            tickLine: { show: false, style: 'solid', size: 1, color: '#e2e8f0', dashedValue: [0, 0], length: 3 },\n            tickText: { show: true, color: '#475569', weight: 400, family: 'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial', size: 10, marginStart: 0, marginEnd: 0 }\n          },\n          crosshair: {\n            show: true,\n            horizontal: {\n              show: true,\n              line: { show: true, style: 'dashed', size: 1, color: '#94a3b8', dashedValue: [2, 3] },\n              text: {\n                show: true,\n                color: '#0f172a',\n                size: 10,\n                family: 'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',\n                weight: 500,\n                paddingLeft: 6, paddingRight: 6, paddingTop: 2, paddingBottom: 2,\n                borderRadius: 4,\n                backgroundColor: '#f8fafc',\n                borderStyle: 'solid', borderDashedValue: [0, 0], borderSize: 1, borderColor: '#e2e8f0'\n              }\n            },\n            vertical: {\n              show: true,\n              line: { show: true, style: 'dashed', size: 1, color: '#94a3b8', dashedValue: [2, 3] },\n              text: {\n                show: true,\n                color: '#0f172a',\n                size: 10,\n                family: 'Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial',\n                weight: 500,\n                paddingLeft: 6, paddingRight: 6, paddingTop: 2, paddingBottom: 2,\n                borderRadius: 4,\n                backgroundColor: '#f8fafc',\n                borderStyle: 'solid', borderDashedValue: [0, 0], borderSize: 1, borderColor: '#e2e8f0'\n              }\n            }\n          },\n          separator: { size: 1, color: '#e2e8f0', fill: false, activeBackgroundColor: '#e5e7eb' }\n        } as any);\n\n        // Default indicators: none at init; will attach based on active tab below\n      } catch (e) {\n        // ignore style application errors to avoid breaking chart init\n      }\n\n      // Handle responsive resizing\n      const handleResize = () => {\n        if (chartInstance.current) {\n          chartInstance.current.resize();\n        }\n      };\n      window.addEventListener('resize', handleResize);\n      // Slightly tighter bars for a modern look\n      try { chartInstance.current?.setBarSpace?.(8 as any); } catch {}\n      \n      return () => {\n        window.removeEventListener('resize', handleResize);\n      };\n    }\n\n    return () => {\n      if (chartInstance.current && chartRef.current) {\n        const chartElement = chartRef.current;\n        dispose(chartElement);\n        chartInstance.current = null;\n      }\n    };\n  }, []);\n\n  // First load after init and on changes\n  useEffect(() => {\n    if (indexId && chartInstance.current) {\n      loadKlineData(interval);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [indexId, interval]);\n\n  // Load kline data\n  const loadKlineData = useCallback(async (selectedInterval: string) => {\n    if (!chartInstance.current) return;\n\n    setLoading(true);\n\n    try {\n      // Import marketApiService dynamically to avoid circular imports\n      const { marketApiService } = await import('../services/marketApiService');\n      const resp: IndexKlineResponse = await marketApiService.getKlineDataByIndex(indexId, selectedInterval as IndexKlineType);\n\n      const points = Array.isArray(resp?.data) ? resp.data : [];\n      if (!points.length) {\n        setHasData(false);\n        chartInstance.current.applyNewData([]);\n        return;\n      }\n\n      const chartData = points.map(p => ({\n        timestamp: Number(p.t),\n        open: p.o,\n        high: p.h,\n        low: p.l,\n        close: p.c,\n        volume: p.v\n      }));\n\n      // Clear existing data and add new data\n      chartInstance.current.applyNewData(chartData);\n      chartInstance.current.scrollToRealTime?.(0);\n      setDataList(chartData);\n      setHasData(true);\n\n      // Update header metrics\n      const len = chartData.length;\n      if (len >= 2) {\n        const last = chartData[len - 1];\n        const prev = chartData[len - 2];\n        setLastPrice(last.close);\n        setPrevClose(prev.close);\n        setLastOpen(last.open);\n        setLastHigh(last.high);\n        setLastLow(last.low);\n        setLastVol(last.volume);\n        setLastTs(last.timestamp);\n        const start = Math.max(0, len - 14);\n        const vols = chartData.slice(start, len).map(d => d.volume);\n        setAvgVol14(vols.length ? vols.reduce((a, b) => a + b, 0) / vols.length : null);\n      } else if (len === 1) {\n        const last = chartData[0];\n        setLastPrice(last.close);\n        setPrevClose(last.close);\n        setLastOpen(last.open);\n        setLastHigh(last.high);\n        setLastLow(last.low);\n        setLastVol(last.volume);\n        setLastTs(last.timestamp);\n        setAvgVol14(last.volume);\n      } else {\n        setLastPrice(null);\n        setPrevClose(null);\n        setLastOpen(null);\n        setLastHigh(null);\n        setLastLow(null);\n        setLastVol(null);\n        setLastTs(null);\n        setAvgVol14(null);\n      }\n\n      // Update forecast from backend strategy\n      try {\n        const EXT_HORIZONS = Array.from({ length: 30 }, (_, i) => i + 1);\n        const res = await axios.post('/forecast/run', { id: indexId, type: interval, horizons: EXT_HORIZONS, method: fMethod, window: fWindow, params: { alpha: fAlpha, beta: fBeta, use_log: fUseLog ? 1 : 0 }, data: chartData.map(d => ({ t: String(d.timestamp), o: d.open, h: d.high, l: d.low, c: d.close, v: d.volume })) }, { baseURL: '/api/v1' });\n        const preds = res.data?.predictions || {};\n        const cur = chartData.length ? chartData[chartData.length - 1].close : null;\n        const pVal = (d: number) => (preds[d] ?? preds[String(d)]);\n        const build = (d: number) => {\n          const p = pVal(d);\n          if (p == null || cur == null) return undefined;\n          const pct = cur ? ((p - cur) / cur) * 100 : 0;\n          return { price: p, pct };\n        };\n        const forecastsObj: Record<number, { price: number; pct: number }> = {};\n        [7,14,30].forEach((d) => { const v = build(d); if (v) forecastsObj[d] = v; });\n        setForecast({ d7: forecastsObj[7], d14: forecastsObj[14], d30: forecastsObj[30] });\n        let earliest: number | null = null;\n        let earliestTarget: number | null = null;\n        let earliestPct: number | null = null;\n        let minDay: number | null = null;\n        let minPrice: number | null = null;\n        const minGain = fThreshPct + fCostPct;\n        const daily: Array<{day:number;pct:number;netPct:number;hit:boolean}> = [];\n        if (cur != null) {\n          for (const d of EXT_HORIZONS) {\n            const p = pVal(d);\n            if (typeof p === 'number') {\n              if (minPrice == null || p < minPrice) { minPrice = p; minDay = d; }\n              const pct = ((p - cur) / cur) * 100;\n              const net = pct - (fCostPct);\n              const hit = pct >= minGain;\n              daily.push({ day: d, pct, netPct: net, hit });\n              if (earliest == null && pct >= minGain) {\n                earliest = d; earliestTarget = p; earliestPct = pct;\n              }\n            }\n          }\n        }\n        setEarliestProfitDays(earliest);\n        setEarliestProfitTarget(earliestTarget);\n        setEarliestProfitPct(earliestPct);\n        setBestEntryDay(minDay);\n        if (lastTs && minDay != null) {\n          const dt = new Date(Number(lastTs) + minDay * 24 * 60 * 60 * 1000);\n          setBestEntryDate(dt.toLocaleDateString());\n        } else {\n          setBestEntryDate('');\n        }\n        setBestEntryPrice(minPrice ?? null);\n        setCurve(daily);\n\n        onForecastUpdate && onForecastUpdate({\n          currentPrice: cur,\n          forecasts: forecastsObj,\n          // @ts-ignore\n          minGainPct: minGain,\n          // @ts-ignore\n          useLog: fUseLog,\n          earliestProfitDays: earliest,\n          earliestProfitTarget: earliestTarget,\n          earliestProfitPct: earliestPct,\n          bestEntryDay: minDay,\n          bestEntryPrice: minPrice ?? null,\n        });\n      } catch {}\n\n      // Fetch backtest metrics (1..30 days)\n      try {\n        const EXT_HORIZONS = Array.from({ length: 30 }, (_, i) => i + 1);\n        const res = await axios.post('/forecast/backtest', { id: indexId, type: interval, horizons: EXT_HORIZONS, method: fMethod, window: fWindow, step: 5, params: { alpha: fAlpha, beta: fBeta, use_log: fUseLog ? 1 : 0 }, data: chartData.map(d => ({ t: String(d.timestamp), o: d.open, h: d.high, l: d.low, c: d.close, v: d.volume })) }, { baseURL: '/api/v1' });\n        setBtMetrics(res.data?.metrics || null);\n      } catch {}\n\n    } catch (err: any) {\n      console.error('K线数据加载错误:', err);\n      setHasData(false);\n    } finally {\n      setLoading(false);\n    }\n  }, [indexId]);\n\n  // Fetch forecasts only when settings change\n  useEffect(() => {\n    const run = async () => {\n      if (!chartInstance.current || !dataList.length) return;\n      try {\n        const EXT_HORIZONS = Array.from({ length: 30 }, (_, i) => i + 1);\n        const res = await axios.post('/forecast/run', { id: indexId, type: interval, horizons: EXT_HORIZONS, method: fMethod, window: fWindow, params: { alpha: fAlpha, beta: fBeta, use_log: fUseLog ? 1 : 0 }, data: dataList.map(d => ({ t: String(d.timestamp), o: d.open, h: d.high, l: d.low, c: d.close, v: d.volume })) }, { baseURL: '/api/v1' });\n        const preds = res.data?.predictions || {};\n        const cur = dataList[dataList.length - 1]?.close ?? null;\n        const pVal = (d: number) => (preds[d] ?? preds[String(d)]);\n        const build = (d: number) => {\n          const p = pVal(d);\n          if (p == null || cur == null) return undefined;\n          const pct = cur ? ((p - cur) / cur) * 100 : 0;\n          return { price: p, pct };\n        };\n        const forecastsObj: Record<number, { price: number; pct: number }> = {};\n        [7,14,30].forEach((d) => { const v = build(d); if (v) forecastsObj[d] = v; });\n        setForecast({ d7: forecastsObj[7], d14: forecastsObj[14], d30: forecastsObj[30] });\n        let earliest: number | null = null;\n        let earliestTarget: number | null = null;\n        let earliestPct: number | null = null;\n        let minDay: number | null = null;\n        let minPrice: number | null = null;\n        const minGain = fThreshPct + fCostPct;\n        const daily: Array<{day:number;pct:number;netPct:number;hit:boolean}> = [];\n        if (cur != null) {\n          for (const d of EXT_HORIZONS) {\n            const p = pVal(d);\n            if (typeof p === 'number') {\n              if (minPrice == null || p < minPrice) { minPrice = p; minDay = d; }\n              const pct = ((p - cur) / cur) * 100;\n              const net = pct - (fCostPct);\n              const hit = pct >= minGain;\n              daily.push({ day: d, pct, netPct: net, hit });\n              if (earliest == null && pct >= minGain) {\n                earliest = d; earliestTarget = p; earliestPct = pct;\n              }\n            }\n          }\n        }\n        setEarliestProfitDays(earliest);\n        setEarliestProfitTarget(earliestTarget);\n        setEarliestProfitPct(earliestPct);\n        setBestEntryDay(minDay);\n        if (lastTs && minDay != null) {\n          const dt = new Date(Number(lastTs) + minDay * 24 * 60 * 60 * 1000);\n          setBestEntryDate(dt.toLocaleDateString());\n        } else {\n          setBestEntryDate('');\n        }\n        setBestEntryPrice(minPrice ?? null);\n        setCurve(daily);\n\n        onForecastUpdate && onForecastUpdate({\n          currentPrice: cur,\n          forecasts: forecastsObj,\n          // @ts-ignore\n          minGainPct: minGain,\n          // @ts-ignore\n          useLog: fUseLog,\n          earliestProfitDays: earliest,\n          earliestProfitTarget: earliestTarget,\n          earliestProfitPct: earliestPct,\n          bestEntryDay: minDay,\n          bestEntryPrice: minPrice ?? null,\n        });\n      } catch {}\n      try {\n        const EXT_HORIZONS = Array.from({ length: 30 }, (_, i) => i + 1);\n        const res = await axios.post('/forecast/backtest', { id: indexId, type: interval, horizons: EXT_HORIZONS, method: fMethod, window: fWindow, step: 5, params: { alpha: fAlpha, beta: fBeta, use_log: fUseLog ? 1 : 0 }, data: dataList.map(d => ({ t: String(d.timestamp), o: d.open, h: d.high, l: d.low, c: d.close, v: d.volume })) }, { baseURL: '/api/v1' });\n        setBtMetrics(res.data?.metrics || null);\n      } catch {}\n    };\n    run();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fMethod, fWindow, fAlpha, fBeta]);\n\n  // Manual refresh support\n  useEffect(() => {\n    if (indexId && chartInstance.current) {\n      loadKlineData(interval);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [refreshToken]);\n\n  const handleIntervalChange = (newInterval: IndexKlineType) => {\n    setInterval(newInterval);\n    if (onIntervalChange) {\n      onIntervalChange(newInterval);\n    }\n  };\n\n  // Compute change\n  const changeAbs = lastPrice != null && prevClose != null ? lastPrice - prevClose : null;\n  const changePct = changeAbs != null && prevClose ? (changeAbs / prevClose) * 100 : null;\n  const up = (changeAbs ?? 0) > 0;\n  const down = (changeAbs ?? 0) < 0;\n  const formatNum = (n: number | null, digits = 2) => (n == null ? '--' : n.toFixed(digits));\n  const formatTS = (ts: number | null) => (ts == null ? '' : new Date(ts).toLocaleString());\n\n  // Remove all known indicators\n  const removeAllIndicators = () => {\n    if (!chartInstance.current) return;\n    const names = ['MA', 'BOLL', 'MACD', 'VOL'];\n    for (const name of names) {\n      // keep removing until none left\n      // @ts-ignore\n      while (chartInstance.current.removeIndicator?.({ name })) {\n        // loop\n      }\n    }\n  };\n\n  const applyIndicatorByTab = (tab: string) => {\n    if (!chartInstance.current) return;\n    removeAllIndicators();\n    try {\n      switch (tab) {\n        case 'MA':\n          chartInstance.current.overrideIndicator?.({ name: 'MA', calcParams: [5, 10, 20] } as any);\n          chartInstance.current.createIndicator('MA', false);\n          break;\n        case 'BOLL':\n          chartInstance.current.createIndicator('BOLL', false as any);\n          break;\n        case 'MACD':\n          chartInstance.current.overrideIndicator?.({ name: 'MACD', calcParams: [12, 26, 9] } as any);\n          chartInstance.current.createIndicator('MACD', false, { height: 120 } as any);\n          break;\n        case 'VOL':\n          chartInstance.current.overrideIndicator?.({ name: 'VOL', calcParams: [5, 10] } as any);\n          chartInstance.current.createIndicator('VOL', false, { height: 96 } as any);\n          break;\n        default:\n          break;\n      }\n    } catch {}\n  };\n\n  useEffect(() => {\n    applyIndicatorByTab(activeTab);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [activeTab, chartInstance.current]);\n\n\n  return (\n    <div style={{ position: 'relative' }}>\n      <div style={{\n        marginBottom: 12,\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center'\n      }}>\n        <Space size={12} wrap>\n          <Text strong style={{ color: '#334155' }}>{`指数ID: ${indexId}`}</Text>\n          <Segmented\n            size=\"small\"\n            value={interval}\n            options={[\n              { label: '1小时', value: '1hour' },\n              { label: '4小时', value: '4hour' },\n              { label: '日线', value: '1day' },\n              { label: '周线', value: '7day' }\n            ]}\n            onChange={(val) => handleIntervalChange(val as IndexKlineType)}\n          />\n        </Space>\n        <Space size={10} wrap>\n          {lastPrice != null && (\n            <Text style={{ color: up ? '#2ECB7A' : down ? '#F64E4E' : '#cbd5e1', fontWeight: 600 }}>\n              {formatNum(lastPrice)} {changeAbs != null && changePct != null && ((up ? '+' : '') + `${formatNum(changeAbs)} (${formatNum(changePct)}%)`)}\n            </Text>\n          )}\n          <Text type=\"secondary\" style={{ color: '#475569' }}>O {formatNum(lastOpen)}</Text>\n          <Text type=\"secondary\" style={{ color: '#475569' }}>H {formatNum(lastHigh)}</Text>\n          <Text type=\"secondary\" style={{ color: '#475569' }}>L {formatNum(lastLow)}</Text>\n          <Text type=\"secondary\" style={{ color: '#475569' }}>C {formatNum(lastPrice)}</Text>\n          <Text type=\"secondary\" style={{ color: '#64748b' }}>量 {formatNum(lastVol, 0)}{avgVol14 != null ? ` / 均量14 ${formatNum(avgVol14, 0)}` : ''}</Text>\n          <Text type=\"secondary\" style={{ color: '#94a3b8' }}>{formatTS(lastTs)}</Text>\n          \n          {loading && <Spin size=\"small\" />}\n        </Space>\n      </div>\n\n      {/* Forecast summary */}\n      <div style={{ marginTop: 12 }}>\n        <Card size=\"small\" bordered style={{ borderRadius: 8 }}>\n          <Space size={24} wrap>\n            <div>\n              <Text strong>7天预测</Text>\n              <div>\n                {forecast.d7 ? (\n                  <Text style={{ color: (forecast.d7.pct > 0 ? '#16a34a' : forecast.d7.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d7.price)} ({formatNum(forecast.d7.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>14天预测</Text>\n              <div>\n                {forecast.d14 ? (\n                  <Text style={{ color: (forecast.d14.pct > 0 ? '#16a34a' : forecast.d14.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d14.price)} ({formatNum(forecast.d14.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>30天预测</Text>\n              <div>\n                {forecast.d30 ? (\n                  <Text style={{ color: (forecast.d30.pct > 0 ? '#16a34a' : forecast.d30.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d30.price)} ({formatNum(forecast.d30.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>最早盈利天数</Text>\n              <div>\n                {earliestProfitDays != null ? (\n                  <>\n                    <Text style={{ color: '#334155' }}>{earliestProfitDays} 天</Text>\n                    {earliestProfitTarget != null && earliestProfitPct != null && (\n                      <Text style={{ marginLeft: 8, color: earliestProfitPct > 0 ? '#16a34a' : earliestProfitPct < 0 ? '#ef4444' : '#334155' }}>\n                        目标价 {formatNum(earliestProfitTarget)} ({formatNum(earliestProfitPct)}%)\n                      </Text>\n                    )}\n                  </>\n                ) : (\n                  <Text type=\"secondary\">暂无</Text>\n                )}\n              </div>\n            </div>\n            <div>\n              <Text strong>最佳入手日期</Text>\n              <div>\n                {bestEntryDay != null && bestEntryPrice != null ? (\n                  <>\n                    <Text style={{ color: '#334155' }}>{bestEntryDate || `${bestEntryDay} 天后`}</Text>\n                    <Text style={{ marginLeft: 8, color: '#334155' }}>预测价 {formatNum(bestEntryPrice)}</Text>\n                  </>\n                ) : (\n                  <Text type=\"secondary\">暂无</Text>\n                )}\n              </div>\n            </div>\n            \n          </Space>\n        </Card>\n      </div>\n\n      {/* Cumulative returns view */}\n      <div style={{ marginTop: 12 }}>\n        <Card size=\"small\" bordered style={{ borderRadius: 8 }} title=\"累计收益（1~30天）\">\n          {curve.length ? (\n            <Table\n              size=\"small\"\n              pagination={false}\n              rowKey={(r:any)=> String(r.day)}\n              columns={[\n                { title: '天数', dataIndex: 'day', width: 60 },\n                { title: '预测%', dataIndex: 'pct', width: 100, render:(v:number)=> `${formatNum(v,2)}` },\n                { title: '净收益%', dataIndex: 'netPct', width: 100, render:(v:number)=> `${formatNum(v,2)}` },\n                { title: '达标', dataIndex: 'hit', width: 80, render:(v:boolean)=> v? '是':'否' },\n              ] as any}\n              dataSource={curve}\n            />\n          ) : (\n            <Text type=\"secondary\">暂无数据</Text>\n          )}\n        </Card>\n      </div>\n\n      {/* Backtest metrics */}\n      <div style={{ marginTop: 12 }}>\n        <Card size=\"small\" bordered style={{ borderRadius: 8 }} title=\"预测准确率回溯（1~30天）\">\n          {btMetrics ? (\n            <Table\n              size=\"small\"\n              pagination={false}\n              rowKey={(r: any) => String(r.day)}\n              columns={[\n                { title: '天数', dataIndex: 'day', width: 60 },\n                { title: '样本', dataIndex: 'points', width: 80 },\n                { title: 'MAPE%', dataIndex: 'mape', width: 100 },\n                { title: 'MAE', dataIndex: 'mae', width: 100 },\n                { title: 'RMSE', dataIndex: 'rmse', width: 100 },\n                { title: '命中率%', dataIndex: 'hit', width: 100 },\n              ] as any}\n              dataSource={Array.from({ length: 30 }, (_, i) => i + 1).map((d) => {\n                const k = String(d);\n                const m = btMetrics[k] as any;\n                return {\n                  day: d,\n                  points: m?.points ?? 0,\n                  mape: m ? `${formatNum(m.mape, 2)}` : '--',\n                  mae: m ? `${formatNum(m.mae, 2)}` : '--',\n                  rmse: m ? `${formatNum(m.rmse, 2)}` : '--',\n                  hit: m ? `${formatNum(m.hit_rate, 2)}` : '--',\n                };\n              })}\n            />\n          ) : (\n            <Text type=\"secondary\">正在加载回溯指标...</Text>\n          )}\n        </Card>\n      </div>\n\n      <div style={{ marginBottom: 8 }}>\n        <Tabs\n          size=\"small\"\n          activeKey={activeTab}\n          onChange={setActiveTab}\n          items={[\n            { key: 'MA', label: 'MA 均线' },\n            { key: 'BOLL', label: 'BOLL 布林带' },\n            { key: 'MACD', label: 'MACD 动能' },\n            { key: 'VOL', label: 'VOL 成交量' },\n          ]}\n        />\n      </div>\n\n      {/* Forecast settings */}\n      <Card\n        size=\"small\"\n        style={{ marginBottom: 8, borderRadius: 8 }}\n        title={\n          <Space size={6}>\n            预测设置\n            <Tooltip\n              overlayStyle={{ maxWidth: 420 }}\n              title={\n                <div style={{ fontSize: 12, lineHeight: 1.6 }}>\n                  <div><b>方法选择</b>：linreg（线性趋势），EMA（更灵敏），Holt（水平+趋势）。</div>\n                  <div><b>窗口 window</b>：建议 100–200；越大越平滑，越小越敏感。</div>\n                  <div><b>α（EMA/Holt）</b>：建议 0.2–0.5；越大越看重最新数据。</div>\n                  <div><b>β（Holt）</b>：建议 0.05–0.2；越大趋势更新更快。</div>\n                  <div><b>回测 step</b>：建议 3–10；越小样本更多但耗时更长。</div>\n                  <div style={{ color: '#64748b' }}>以上为经验值，仅供量化参考，非投资建议。</div>\n                </div>\n              }\n            >\n              <QuestionCircleOutlined style={{ color: '#64748b' }} />\n            </Tooltip>\n          </Space>\n        }\n      >\n        <Space size={12} wrap>\n          <span>方法</span>\n          <Segmented\n            size=\"small\"\n            value={fMethod}\n            onChange={(v) => setFMethod(v as any)}\n            options={[{ label: '线性回归', value: 'linreg' }, { label: 'EMA', value: 'ema' }, { label: 'Holt', value: 'holt' }]}\n          />\n\n          <span>窗口</span>\n          <Select size=\"small\" value={fWindow} onChange={setFWindow} style={{ width: 120 }}\n            options={[{ value: 50, label: '50' }, { value: 100, label: '100' }, { value: 200, label: '200' }, { value: 300, label: '300' }]} />\n\n          {(fMethod === 'ema' || fMethod === 'holt') && (\n            <>\n              <span>α</span>\n              <InputNumber size=\"small\" value={fAlpha} min={0.01} max={0.99} step={0.05} onChange={(v) => setFAlpha(Number(v))} />\n            </>\n          )}\n          {fMethod === 'holt' && (\n            <>\n              <span>β</span>\n              <InputNumber size=\"small\" value={fBeta} min={0.0} max={0.99} step={0.05} onChange={(v) => setFBeta(Number(v))} />\n            </>\n          )}\n\n          <span>对数预测</span>\n          <Segmented size=\"small\" value={fUseLog ? 'on' : 'off'} onChange={(v)=> setFUseLog(v === 'on')} options={[{label:'开',value:'on'},{label:'关',value:'off'}]} />\n\n          <span>收益阈值%</span>\n          <InputNumber size=\"small\" value={fThreshPct} step={0.5} onChange={(v)=> setFThreshPct(Number(v))} />\n          <span>成本%</span>\n          <InputNumber size=\"small\" value={fCostPct} step={0.5} onChange={(v)=> setFCostPct(Number(v))} />\n        </Space>\n      </Card>\n\n      <div\n        ref={chartRef}\n        style={{\n          width: '100%',\n          height: `${height}px`,\n          backgroundColor: '#ffffff',\n          borderRadius: 8,\n          border: '1px solid #e2e8f0',\n          position: 'relative'\n        }}\n      />\n\n      {/* Forecast summary */}\n      <div style={{ marginTop: 12 }}>\n        <Card size=\"small\" bordered style={{ borderRadius: 8 }}>\n          <Space size={24} wrap>\n            <div>\n              <Text strong>7天预测</Text>\n              <div>\n                {forecast.d7 ? (\n                  <Text style={{ color: (forecast.d7.pct > 0 ? '#16a34a' : forecast.d7.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d7.price)} ({formatNum(forecast.d7.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>14天预测</Text>\n              <div>\n                {forecast.d14 ? (\n                  <Text style={{ color: (forecast.d14.pct > 0 ? '#16a34a' : forecast.d14.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d14.price)} ({formatNum(forecast.d14.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>30天预测</Text>\n              <div>\n                {forecast.d30 ? (\n                  <Text style={{ color: (forecast.d30.pct > 0 ? '#16a34a' : forecast.d30.pct < 0 ? '#ef4444' : '#334155') }}>\n                    {formatNum(forecast.d30.price)} ({formatNum(forecast.d30.pct)}%)\n                  </Text>\n                ) : <Text type=\"secondary\">—</Text>}\n              </div>\n            </div>\n            <div>\n              <Text strong>最早盈利天数</Text>\n              <div>\n                {earliestProfitDays != null ? (\n                  <>\n                    <Text style={{ color: '#334155' }}>{earliestProfitDays} 天</Text>\n                    {earliestProfitTarget != null && earliestProfitPct != null && (\n                      <Text style={{ marginLeft: 8, color: earliestProfitPct > 0 ? '#16a34a' : earliestProfitPct < 0 ? '#ef4444' : '#334155' }}>\n                        目标价 {formatNum(earliestProfitTarget)} ({formatNum(earliestProfitPct)}%)\n                      </Text>\n                    )}\n                  </>\n                ) : (\n                  <Text type=\"secondary\">暂无</Text>\n                )}\n              </div>\n            </div>\n            <div>\n              <Text strong>最佳入手日期</Text>\n              <div>\n                {bestEntryDay != null && bestEntryPrice != null ? (\n                  <>\n                    <Text style={{ color: '#334155' }}>{bestEntryDate || `${bestEntryDay} 天后`}</Text>\n                    <Text style={{ marginLeft: 8, color: '#334155' }}>预测价 {formatNum(bestEntryPrice)}</Text>\n                  </>\n                ) : (\n                  <Text type=\"secondary\">暂无</Text>\n                )}\n              </div>\n            </div>\n            \n          </Space>\n        </Card>\n      </div>\n\n      {/* help content moved to /help */}\n\n      {loading && (\n        <div\n          style={{\n            position: 'absolute',\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            backgroundColor: 'rgba(0, 0, 0, 0.7)',\n            borderRadius: '4px',\n            padding: '20px',\n            zIndex: 1000\n          }}\n        >\n          <Spin size=\"large\" />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default KlineChart;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CACvE,OAASC,IAAI,CAAEC,OAAO,KAAe,aAAa,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,SAAS,CAAEC,IAAI,CAAEC,UAAU,CAAEC,KAAK,CAAUC,IAAI,CAAEC,IAAI,CAAEC,WAAW,CAAEC,MAAM,CAAEC,OAAO,CAAEC,KAAK,KAAQ,MAAM,CAClH,OAASC,sBAAsB,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAG3D,KAAM,CAAEC,IAAK,CAAC,CAAGf,UAAU,CAoB3B,KAAM,CAAAgB,UAAqC,CAAGC,IAAA,EAMxC,IANyC,CAC7CC,OAAO,CACPC,MAAM,CAAG,GAAG,CACZC,gBAAgB,CAChBC,YAAY,CACZC,gBACF,CAAC,CAAAL,IAAA,CACC,KAAM,CAAAM,QAAQ,CAAG/B,MAAM,CAAiB,IAAI,CAAC,CAC7C,KAAM,CAAAgC,aAAa,CAAGhC,MAAM,CAAe,IAAI,CAAC,CAChD,KAAM,CAACiC,OAAO,CAAEC,UAAU,CAAC,CAAGjC,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACkC,OAAO,CAAEC,UAAU,CAAC,CAAGnC,QAAQ,CAAU,KAAK,CAAC,CACtD,KAAM,CAACoC,QAAQ,CAAEC,WAAW,CAAC,CAAGrC,QAAQ,CAAiB,MAAM,CAAC,CAChE,KAAM,CAACsC,SAAS,CAAEC,YAAY,CAAC,CAAGvC,QAAQ,CAAgB,IAAI,CAAC,CAC/D,KAAM,CAACwC,SAAS,CAAEC,YAAY,CAAC,CAAGzC,QAAQ,CAAgB,IAAI,CAAC,CAC/D,KAAM,CAAC0C,QAAQ,CAAEC,WAAW,CAAC,CAAG3C,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAAC4C,QAAQ,CAAEC,WAAW,CAAC,CAAG7C,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAAC8C,OAAO,CAAEC,UAAU,CAAC,CAAG/C,QAAQ,CAAgB,IAAI,CAAC,CAC3D,KAAM,CAACgD,OAAO,CAAEC,UAAU,CAAC,CAAGjD,QAAQ,CAAgB,IAAI,CAAC,CAC3D,KAAM,CAACkD,MAAM,CAAEC,SAAS,CAAC,CAAGnD,QAAQ,CAAgB,IAAI,CAAC,CACzD,KAAM,CAACoD,QAAQ,CAAEC,WAAW,CAAC,CAAGrD,QAAQ,CAAgB,IAAI,CAAC,CAC7D,KAAM,CAACsD,SAAS,CAAEC,YAAY,CAAC,CAAGvD,QAAQ,CAAS,IAAI,CAAC,CACxD,KAAM,CAACwD,QAAQ,CAAEC,WAAW,CAAC,CAAGzD,QAAQ,CAAuG,EAAE,CAAC,CAClJ,KAAM,CAAC0D,QAAQ,CAAEC,WAAW,CAAC,CAAG3D,QAAQ,CAAsH,CAAC,CAAC,CAAC,CACjK,KAAM,CAAC4D,SAAS,CAAEC,YAAY,CAAC,CAAG7D,QAAQ,CAAqF,IAAI,CAAC,CACpI,KAAM,CAAC8D,OAAO,CAAEC,UAAU,CAAC,CAAG/D,QAAQ,CAA4B,QAAQ,CAAC,CAC3E,KAAM,CAACgE,OAAO,CAAEC,UAAU,CAAC,CAAGjE,QAAQ,CAAS,GAAG,CAAC,CACnD,KAAM,CAACkE,MAAM,CAAEC,SAAS,CAAC,CAAGnE,QAAQ,CAAS,GAAG,CAAC,CACjD,KAAM,CAACoE,KAAK,CAAEC,QAAQ,CAAC,CAAGrE,QAAQ,CAAS,GAAG,CAAC,CAC/C,KAAM,CAACsE,OAAO,CAAEC,UAAU,CAAC,CAAGvE,QAAQ,CAAU,IAAI,CAAC,CACrD,KAAM,CAACwE,UAAU,CAAEC,aAAa,CAAC,CAAGzE,QAAQ,CAAS,CAAC,CAAC,CACvD,KAAM,CAAC0E,QAAQ,CAAEC,WAAW,CAAC,CAAG3E,QAAQ,CAAS,CAAC,CAAC,CACnD,KAAM,CAAC4E,kBAAkB,CAAEC,qBAAqB,CAAC,CAAG7E,QAAQ,CAAgB,IAAI,CAAC,CACjF,KAAM,CAAC8E,oBAAoB,CAAEC,uBAAuB,CAAC,CAAG/E,QAAQ,CAAgB,IAAI,CAAC,CACrF,KAAM,CAACgF,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGjF,QAAQ,CAAgB,IAAI,CAAC,CAC/E,KAAM,CAACkF,YAAY,CAAEC,eAAe,CAAC,CAAGnF,QAAQ,CAAgB,IAAI,CAAC,CACrE,KAAM,CAACoF,aAAa,CAAEC,gBAAgB,CAAC,CAAGrF,QAAQ,CAAS,EAAE,CAAC,CAC9D,KAAM,CAACsF,cAAc,CAAEC,iBAAiB,CAAC,CAAGvF,QAAQ,CAAgB,IAAI,CAAC,CACzE,KAAM,CAACwF,KAAK,CAAEC,QAAQ,CAAC,CAAGzF,QAAQ,CAAoE,EAAE,CAAC,CACzG;AAEA;AACAF,SAAS,CAAC,IAAM,CACd,GAAIgC,QAAQ,CAAC4D,OAAO,EAAI,CAAC3D,aAAa,CAAC2D,OAAO,CAAE,CAC9C3D,aAAa,CAAC2D,OAAO,CAAGxF,IAAI,CAAC4B,QAAQ,CAAC4D,OAAO,CAAC,CAE9C;AACA,GAAI,CACF3D,aAAa,CAAC2D,OAAO,CAACC,SAAS,CAAC,CAC9BC,IAAI,CAAE,CACJC,IAAI,CAAE,IAAI,CACVC,UAAU,CAAE,CAAED,IAAI,CAAE,IAAI,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CAC1FC,QAAQ,CAAE,CAAEN,IAAI,CAAE,IAAI,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CACzF,CAAC,CACDE,MAAM,CAAE,CACNC,IAAI,CAAE,cAAc,CACpBC,GAAG,CAAE,CACHC,WAAW,CAAE,gBAAgB,CAC7BC,OAAO,CAAE,SAAS,CAClBC,SAAS,CAAE,SAAS,CACpBC,aAAa,CAAE,SAAS,CACxBC,aAAa,CAAE,SAAS,CACxBC,eAAe,CAAE,SAAS,CAC1BC,mBAAmB,CAAE,SAAS,CAC9BC,WAAW,CAAE,SAAS,CACtBC,aAAa,CAAE,SAAS,CACxBC,iBAAiB,CAAE,SACrB,CACF,CAAC,CACDC,KAAK,CAAE,CACLpB,IAAI,CAAE,IAAI,CACVG,IAAI,CAAE,MAAM,CACZkB,QAAQ,CAAE,CAAErB,IAAI,CAAE,KAAK,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CACzFiB,QAAQ,CAAE,CAAEtB,IAAI,CAAE,KAAK,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CAAEkB,MAAM,CAAE,CAAE,CAAC,CACpGC,QAAQ,CAAE,CAAExB,IAAI,CAAE,IAAI,CAAEI,KAAK,CAAE,SAAS,CAAEqB,MAAM,CAAE,GAAG,CAAEC,MAAM,CAAE,qEAAqE,CAAEvB,IAAI,CAAE,EAAE,CAAEwB,WAAW,CAAE,CAAC,CAAEC,SAAS,CAAE,CAAE,CAC/K,CAAC,CACDC,KAAK,CAAE,CACL7B,IAAI,CAAE,IAAI,CACVG,IAAI,CAAE,MAAM,CACZkB,QAAQ,CAAE,CAAErB,IAAI,CAAE,KAAK,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CACzFiB,QAAQ,CAAE,CAAEtB,IAAI,CAAE,KAAK,CAAEE,KAAK,CAAE,OAAO,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CAAEkB,MAAM,CAAE,CAAE,CAAC,CACpGC,QAAQ,CAAE,CAAExB,IAAI,CAAE,IAAI,CAAEI,KAAK,CAAE,SAAS,CAAEqB,MAAM,CAAE,GAAG,CAAEC,MAAM,CAAE,qEAAqE,CAAEvB,IAAI,CAAE,EAAE,CAAEwB,WAAW,CAAE,CAAC,CAAEC,SAAS,CAAE,CAAE,CAC/K,CAAC,CACDE,SAAS,CAAE,CACT9B,IAAI,CAAE,IAAI,CACVC,UAAU,CAAE,CACVD,IAAI,CAAE,IAAI,CACV+B,IAAI,CAAE,CAAE/B,IAAI,CAAE,IAAI,CAAEE,KAAK,CAAE,QAAQ,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CACrF2B,IAAI,CAAE,CACJhC,IAAI,CAAE,IAAI,CACVI,KAAK,CAAE,SAAS,CAChBD,IAAI,CAAE,EAAE,CACRuB,MAAM,CAAE,qEAAqE,CAC7ED,MAAM,CAAE,GAAG,CACXQ,WAAW,CAAE,CAAC,CAAEC,YAAY,CAAE,CAAC,CAAEC,UAAU,CAAE,CAAC,CAAEC,aAAa,CAAE,CAAC,CAChEC,YAAY,CAAE,CAAC,CACfC,eAAe,CAAE,SAAS,CAC1BC,WAAW,CAAE,OAAO,CAAEC,iBAAiB,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CAAEC,UAAU,CAAE,CAAC,CAAEC,WAAW,CAAE,SAC/E,CACF,CAAC,CACDpC,QAAQ,CAAE,CACRN,IAAI,CAAE,IAAI,CACV+B,IAAI,CAAE,CAAE/B,IAAI,CAAE,IAAI,CAAEE,KAAK,CAAE,QAAQ,CAAEC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEC,WAAW,CAAE,CAAC,CAAC,CAAE,CAAC,CAAE,CAAC,CACrF2B,IAAI,CAAE,CACJhC,IAAI,CAAE,IAAI,CACVI,KAAK,CAAE,SAAS,CAChBD,IAAI,CAAE,EAAE,CACRuB,MAAM,CAAE,qEAAqE,CAC7ED,MAAM,CAAE,GAAG,CACXQ,WAAW,CAAE,CAAC,CAAEC,YAAY,CAAE,CAAC,CAAEC,UAAU,CAAE,CAAC,CAAEC,aAAa,CAAE,CAAC,CAChEC,YAAY,CAAE,CAAC,CACfC,eAAe,CAAE,SAAS,CAC1BC,WAAW,CAAE,OAAO,CAAEC,iBAAiB,CAAE,CAAC,CAAC,CAAE,CAAC,CAAC,CAAEC,UAAU,CAAE,CAAC,CAAEC,WAAW,CAAE,SAC/E,CACF,CACF,CAAC,CACDC,SAAS,CAAE,CAAExC,IAAI,CAAE,CAAC,CAAEC,KAAK,CAAE,SAAS,CAAEwC,IAAI,CAAE,KAAK,CAAEC,qBAAqB,CAAE,SAAU,CACxF,CAAQ,CAAC,CAET;AACF,CAAE,MAAOC,CAAC,CAAE,CACV;AAAA,CAGF;AACA,KAAM,CAAAC,YAAY,CAAGA,CAAA,GAAM,CACzB,GAAI7G,aAAa,CAAC2D,OAAO,CAAE,CACzB3D,aAAa,CAAC2D,OAAO,CAACmD,MAAM,CAAC,CAAC,CAChC,CACF,CAAC,CACDC,MAAM,CAACC,gBAAgB,CAAC,QAAQ,CAAEH,YAAY,CAAC,CAC/C;AACA,GAAI,KAAAI,qBAAA,CAAAC,sBAAA,CAAE,CAAAD,qBAAA,CAAAjH,aAAa,CAAC2D,OAAO,UAAAsD,qBAAA,kBAAAC,sBAAA,CAArBD,qBAAA,CAAuBE,WAAW,UAAAD,sBAAA,iBAAlCA,sBAAA,CAAAE,IAAA,CAAAH,qBAAA,CAAqC,CAAQ,CAAC,CAAE,CAAE,MAAAI,OAAA,CAAM,CAAC,CAE/D,MAAO,IAAM,CACXN,MAAM,CAACO,mBAAmB,CAAC,QAAQ,CAAET,YAAY,CAAC,CACpD,CAAC,CACH,CAEA,MAAO,IAAM,CACX,GAAI7G,aAAa,CAAC2D,OAAO,EAAI5D,QAAQ,CAAC4D,OAAO,CAAE,CAC7C,KAAM,CAAA4D,YAAY,CAAGxH,QAAQ,CAAC4D,OAAO,CACrCvF,OAAO,CAACmJ,YAAY,CAAC,CACrBvH,aAAa,CAAC2D,OAAO,CAAG,IAAI,CAC9B,CACF,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN;AACA5F,SAAS,CAAC,IAAM,CACd,GAAI2B,OAAO,EAAIM,aAAa,CAAC2D,OAAO,CAAE,CACpC6D,aAAa,CAACnH,QAAQ,CAAC,CACzB,CACA;AACF,CAAC,CAAE,CAACX,OAAO,CAAEW,QAAQ,CAAC,CAAC,CAEvB;AACA,KAAM,CAAAmH,aAAa,CAAGtJ,WAAW,CAAC,KAAO,CAAAuJ,gBAAwB,EAAK,CACpE,GAAI,CAACzH,aAAa,CAAC2D,OAAO,CAAE,OAE5BzD,UAAU,CAAC,IAAI,CAAC,CAEhB,GAAI,KAAAwH,sBAAA,CAAAC,sBAAA,CACF;AACA,KAAM,CAAEC,gBAAiB,CAAC,CAAG,KAAM,OAAM,CAAC,8BAA8B,CAAC,CACzE,KAAM,CAAAC,IAAwB,CAAG,KAAM,CAAAD,gBAAgB,CAACE,mBAAmB,CAACpI,OAAO,CAAE+H,gBAAkC,CAAC,CAExH,KAAM,CAAAM,MAAM,CAAGC,KAAK,CAACC,OAAO,CAACJ,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,IAAI,CAAC,CAAGL,IAAI,CAACK,IAAI,CAAG,EAAE,CACzD,GAAI,CAACH,MAAM,CAAC1C,MAAM,CAAE,CAClBjF,UAAU,CAAC,KAAK,CAAC,CACjBJ,aAAa,CAAC2D,OAAO,CAACwE,YAAY,CAAC,EAAE,CAAC,CACtC,OACF,CAEA,KAAM,CAAAC,SAAS,CAAGL,MAAM,CAACM,GAAG,CAACC,CAAC,GAAK,CACjCC,SAAS,CAAEC,MAAM,CAACF,CAAC,CAACG,CAAC,CAAC,CACtBC,IAAI,CAAEJ,CAAC,CAACK,CAAC,CACTC,IAAI,CAAEN,CAAC,CAACO,CAAC,CACTC,GAAG,CAAER,CAAC,CAACS,CAAC,CACRC,KAAK,CAAEV,CAAC,CAACW,CAAC,CACVC,MAAM,CAAEZ,CAAC,CAACa,CACZ,CAAC,CAAC,CAAC,CAEH;AACAnJ,aAAa,CAAC2D,OAAO,CAACwE,YAAY,CAACC,SAAS,CAAC,CAC7C,CAAAV,sBAAA,EAAAC,sBAAA,CAAA3H,aAAa,CAAC2D,OAAO,EAACyF,gBAAgB,UAAA1B,sBAAA,iBAAtCA,sBAAA,CAAAN,IAAA,CAAAO,sBAAA,CAAyC,CAAC,CAAC,CAC3CjG,WAAW,CAAC0G,SAAS,CAAC,CACtBhI,UAAU,CAAC,IAAI,CAAC,CAEhB;AACA,KAAM,CAAAiJ,GAAG,CAAGjB,SAAS,CAAC/C,MAAM,CAC5B,GAAIgE,GAAG,EAAI,CAAC,CAAE,CACZ,KAAM,CAAAC,IAAI,CAAGlB,SAAS,CAACiB,GAAG,CAAG,CAAC,CAAC,CAC/B,KAAM,CAAAE,IAAI,CAAGnB,SAAS,CAACiB,GAAG,CAAG,CAAC,CAAC,CAC/B7I,YAAY,CAAC8I,IAAI,CAACN,KAAK,CAAC,CACxBtI,YAAY,CAAC6I,IAAI,CAACP,KAAK,CAAC,CACxBpI,WAAW,CAAC0I,IAAI,CAACZ,IAAI,CAAC,CACtB5H,WAAW,CAACwI,IAAI,CAACV,IAAI,CAAC,CACtB5H,UAAU,CAACsI,IAAI,CAACR,GAAG,CAAC,CACpB5H,UAAU,CAACoI,IAAI,CAACJ,MAAM,CAAC,CACvB9H,SAAS,CAACkI,IAAI,CAACf,SAAS,CAAC,CACzB,KAAM,CAAAiB,KAAK,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAEL,GAAG,CAAG,EAAE,CAAC,CACnC,KAAM,CAAAM,IAAI,CAAGvB,SAAS,CAACwB,KAAK,CAACJ,KAAK,CAAEH,GAAG,CAAC,CAAChB,GAAG,CAACwB,CAAC,EAAIA,CAAC,CAACX,MAAM,CAAC,CAC3D5H,WAAW,CAACqI,IAAI,CAACtE,MAAM,CAAGsE,IAAI,CAACG,MAAM,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKD,CAAC,CAAGC,CAAC,CAAE,CAAC,CAAC,CAAGL,IAAI,CAACtE,MAAM,CAAG,IAAI,CAAC,CACjF,CAAC,IAAM,IAAIgE,GAAG,GAAK,CAAC,CAAE,CACpB,KAAM,CAAAC,IAAI,CAAGlB,SAAS,CAAC,CAAC,CAAC,CACzB5H,YAAY,CAAC8I,IAAI,CAACN,KAAK,CAAC,CACxBtI,YAAY,CAAC4I,IAAI,CAACN,KAAK,CAAC,CACxBpI,WAAW,CAAC0I,IAAI,CAACZ,IAAI,CAAC,CACtB5H,WAAW,CAACwI,IAAI,CAACV,IAAI,CAAC,CACtB5H,UAAU,CAACsI,IAAI,CAACR,GAAG,CAAC,CACpB5H,UAAU,CAACoI,IAAI,CAACJ,MAAM,CAAC,CACvB9H,SAAS,CAACkI,IAAI,CAACf,SAAS,CAAC,CACzBjH,WAAW,CAACgI,IAAI,CAACJ,MAAM,CAAC,CAC1B,CAAC,IAAM,CACL1I,YAAY,CAAC,IAAI,CAAC,CAClBE,YAAY,CAAC,IAAI,CAAC,CAClBE,WAAW,CAAC,IAAI,CAAC,CACjBE,WAAW,CAAC,IAAI,CAAC,CACjBE,UAAU,CAAC,IAAI,CAAC,CAChBE,UAAU,CAAC,IAAI,CAAC,CAChBE,SAAS,CAAC,IAAI,CAAC,CACfE,WAAW,CAAC,IAAI,CAAC,CACnB,CAEA;AACA,GAAI,KAAA2I,SAAA,CAAAC,SAAA,CAAAC,UAAA,CACF,KAAM,CAAAC,YAAY,CAAGpC,KAAK,CAACqC,IAAI,CAAC,CAAEhF,MAAM,CAAE,EAAG,CAAC,CAAE,CAACiF,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAG,CAAC,CAAC,CAChE,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAnM,KAAK,CAACoM,IAAI,CAAC,eAAe,CAAE,CAAEC,EAAE,CAAEhL,OAAO,CAAE4E,IAAI,CAAEjE,QAAQ,CAAEsK,QAAQ,CAAEP,YAAY,CAAEQ,MAAM,CAAE7I,OAAO,CAAEgF,MAAM,CAAE9E,OAAO,CAAE4I,MAAM,CAAE,CAAEC,KAAK,CAAE3I,MAAM,CAAE4I,IAAI,CAAE1I,KAAK,CAAE2I,OAAO,CAAEzI,OAAO,CAAG,CAAC,CAAG,CAAE,CAAC,CAAE2F,IAAI,CAAEE,SAAS,CAACC,GAAG,CAACwB,CAAC,GAAK,CAAEpB,CAAC,CAAEwC,MAAM,CAACpB,CAAC,CAACtB,SAAS,CAAC,CAAEI,CAAC,CAAEkB,CAAC,CAACnB,IAAI,CAAEG,CAAC,CAAEgB,CAAC,CAACjB,IAAI,CAAEG,CAAC,CAAEc,CAAC,CAACf,GAAG,CAAEG,CAAC,CAAEY,CAAC,CAACb,KAAK,CAAEG,CAAC,CAAEU,CAAC,CAACX,MAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAEgC,OAAO,CAAE,SAAU,CAAC,CAAC,CACnV,KAAM,CAAAC,KAAK,CAAG,EAAAlB,SAAA,CAAAO,GAAG,CAACtC,IAAI,UAAA+B,SAAA,iBAARA,SAAA,CAAUmB,WAAW,GAAI,CAAC,CAAC,CACzC,KAAM,CAAAC,GAAG,CAAGjD,SAAS,CAAC/C,MAAM,CAAG+C,SAAS,CAACA,SAAS,CAAC/C,MAAM,CAAG,CAAC,CAAC,CAAC2D,KAAK,CAAG,IAAI,CAC3E,KAAM,CAAAsC,IAAI,CAAIzB,CAAS,OAAA0B,QAAA,QAAAA,QAAA,CAAMJ,KAAK,CAACtB,CAAC,CAAC,UAAA0B,QAAA,UAAAA,QAAA,CAAIJ,KAAK,CAACF,MAAM,CAACpB,CAAC,CAAC,CAAC,EAAC,CAC1D,KAAM,CAAA2B,KAAK,CAAI3B,CAAS,EAAK,CAC3B,KAAM,CAAAvB,CAAC,CAAGgD,IAAI,CAACzB,CAAC,CAAC,CACjB,GAAIvB,CAAC,EAAI,IAAI,EAAI+C,GAAG,EAAI,IAAI,CAAE,MAAO,CAAAI,SAAS,CAC9C,KAAM,CAAAC,GAAG,CAAGL,GAAG,CAAI,CAAC/C,CAAC,CAAG+C,GAAG,EAAIA,GAAG,CAAI,GAAG,CAAG,CAAC,CAC7C,MAAO,CAAEM,KAAK,CAAErD,CAAC,CAAEoD,GAAI,CAAC,CAC1B,CAAC,CACD,KAAM,CAAAE,YAA4D,CAAG,CAAC,CAAC,CACvE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAACC,OAAO,CAAEhC,CAAC,EAAK,CAAE,KAAM,CAAAV,CAAC,CAAGqC,KAAK,CAAC3B,CAAC,CAAC,CAAE,GAAIV,CAAC,CAAEyC,YAAY,CAAC/B,CAAC,CAAC,CAAGV,CAAC,CAAE,CAAC,CAAC,CAC7EvH,WAAW,CAAC,CAAEkK,EAAE,CAAEF,YAAY,CAAC,CAAC,CAAC,CAAEG,GAAG,CAAEH,YAAY,CAAC,EAAE,CAAC,CAAEI,GAAG,CAAEJ,YAAY,CAAC,EAAE,CAAE,CAAC,CAAC,CAClF,GAAI,CAAAK,QAAuB,CAAG,IAAI,CAClC,GAAI,CAAAC,cAA6B,CAAG,IAAI,CACxC,GAAI,CAAAC,WAA0B,CAAG,IAAI,CACrC,GAAI,CAAAC,MAAqB,CAAG,IAAI,CAChC,GAAI,CAAAC,QAAuB,CAAG,IAAI,CAClC,KAAM,CAAAC,OAAO,CAAG7J,UAAU,CAAGE,QAAQ,CACrC,KAAM,CAAA4J,KAA+D,CAAG,EAAE,CAC1E,GAAIlB,GAAG,EAAI,IAAI,CAAE,CACf,IAAK,KAAM,CAAAxB,CAAC,GAAI,CAAAO,YAAY,CAAE,CAC5B,KAAM,CAAA9B,CAAC,CAAGgD,IAAI,CAACzB,CAAC,CAAC,CACjB,GAAI,MAAO,CAAAvB,CAAC,GAAK,QAAQ,CAAE,CACzB,GAAI+D,QAAQ,EAAI,IAAI,EAAI/D,CAAC,CAAG+D,QAAQ,CAAE,CAAEA,QAAQ,CAAG/D,CAAC,CAAE8D,MAAM,CAAGvC,CAAC,CAAE,CAClE,KAAM,CAAA6B,GAAG,CAAI,CAACpD,CAAC,CAAG+C,GAAG,EAAIA,GAAG,CAAI,GAAG,CACnC,KAAM,CAAAmB,GAAG,CAAGd,GAAG,CAAI/I,QAAS,CAC5B,KAAM,CAAA8J,GAAG,CAAGf,GAAG,EAAIY,OAAO,CAC1BC,KAAK,CAACG,IAAI,CAAC,CAAEC,GAAG,CAAE9C,CAAC,CAAE6B,GAAG,CAAEkB,MAAM,CAAEJ,GAAG,CAAEC,GAAI,CAAC,CAAC,CAC7C,GAAIR,QAAQ,EAAI,IAAI,EAAIP,GAAG,EAAIY,OAAO,CAAE,CACtCL,QAAQ,CAAGpC,CAAC,CAAEqC,cAAc,CAAG5D,CAAC,CAAE6D,WAAW,CAAGT,GAAG,CACrD,CACF,CACF,CACF,CACA5I,qBAAqB,CAACmJ,QAAQ,CAAC,CAC/BjJ,uBAAuB,CAACkJ,cAAc,CAAC,CACvChJ,oBAAoB,CAACiJ,WAAW,CAAC,CACjC/I,eAAe,CAACgJ,MAAM,CAAC,CACvB,GAAIjL,MAAM,EAAIiL,MAAM,EAAI,IAAI,CAAE,CAC5B,KAAM,CAAAS,EAAE,CAAG,GAAI,CAAAC,IAAI,CAACtE,MAAM,CAACrH,MAAM,CAAC,CAAGiL,MAAM,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CAClE9I,gBAAgB,CAACuJ,EAAE,CAACE,kBAAkB,CAAC,CAAC,CAAC,CAC3C,CAAC,IAAM,CACLzJ,gBAAgB,CAAC,EAAE,CAAC,CACtB,CACAE,iBAAiB,EAAA0G,SAAA,CAACmC,QAAQ,UAAAnC,SAAA,UAAAA,SAAA,CAAI,IAAI,CAAC,CACnCxG,QAAQ,CAAC6I,KAAK,CAAC,CAEfzM,gBAAgB,EAAIA,gBAAgB,CAAC,CACnCkN,YAAY,CAAE3B,GAAG,CACjB4B,SAAS,CAAErB,YAAY,CACvB;AACAsB,UAAU,CAAEZ,OAAO,CACnB;AACAa,MAAM,CAAE5K,OAAO,CACfM,kBAAkB,CAAEoJ,QAAQ,CAC5BlJ,oBAAoB,CAAEmJ,cAAc,CACpCjJ,iBAAiB,CAAEkJ,WAAW,CAC9BhJ,YAAY,CAAEiJ,MAAM,CACpB7I,cAAc,EAAA4G,UAAA,CAAEkC,QAAQ,UAAAlC,UAAA,UAAAA,UAAA,CAAI,IAC9B,CAAC,CAAC,CACJ,CAAE,MAAAiD,QAAA,CAAM,CAAC,CAET;AACA,GAAI,KAAAC,UAAA,CACF,KAAM,CAAAjD,YAAY,CAAGpC,KAAK,CAACqC,IAAI,CAAC,CAAEhF,MAAM,CAAE,EAAG,CAAC,CAAE,CAACiF,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAG,CAAC,CAAC,CAChE,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAnM,KAAK,CAACoM,IAAI,CAAC,oBAAoB,CAAE,CAAEC,EAAE,CAAEhL,OAAO,CAAE4E,IAAI,CAAEjE,QAAQ,CAAEsK,QAAQ,CAAEP,YAAY,CAAEQ,MAAM,CAAE7I,OAAO,CAAEgF,MAAM,CAAE9E,OAAO,CAAEqL,IAAI,CAAE,CAAC,CAAEzC,MAAM,CAAE,CAAEC,KAAK,CAAE3I,MAAM,CAAE4I,IAAI,CAAE1I,KAAK,CAAE2I,OAAO,CAAEzI,OAAO,CAAG,CAAC,CAAG,CAAE,CAAC,CAAE2F,IAAI,CAAEE,SAAS,CAACC,GAAG,CAACwB,CAAC,GAAK,CAAEpB,CAAC,CAAEwC,MAAM,CAACpB,CAAC,CAACtB,SAAS,CAAC,CAAEI,CAAC,CAAEkB,CAAC,CAACnB,IAAI,CAAEG,CAAC,CAAEgB,CAAC,CAACjB,IAAI,CAAEG,CAAC,CAAEc,CAAC,CAACf,GAAG,CAAEG,CAAC,CAAEY,CAAC,CAACb,KAAK,CAAEG,CAAC,CAAEU,CAAC,CAACX,MAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAEgC,OAAO,CAAE,SAAU,CAAC,CAAC,CACjWpJ,YAAY,CAAC,EAAAuL,UAAA,CAAA7C,GAAG,CAACtC,IAAI,UAAAmF,UAAA,iBAARA,UAAA,CAAUE,OAAO,GAAI,IAAI,CAAC,CACzC,CAAE,MAAAC,QAAA,CAAM,CAAC,CAEX,CAAE,MAAOC,GAAQ,CAAE,CACjBC,OAAO,CAACC,KAAK,CAAC,WAAW,CAAEF,GAAG,CAAC,CAC/BrN,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,OAAS,CACRF,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAAE,CAACR,OAAO,CAAC,CAAC,CAEb;AACA3B,SAAS,CAAC,IAAM,CACd,KAAM,CAAA6P,GAAG,CAAG,KAAAA,CAAA,GAAY,CACtB,GAAI,CAAC5N,aAAa,CAAC2D,OAAO,EAAI,CAAClC,QAAQ,CAAC4D,MAAM,CAAE,OAChD,GAAI,KAAAwI,UAAA,CAAAC,eAAA,CAAAC,SAAA,CAAAC,UAAA,CAAAC,UAAA,CACF,KAAM,CAAA7D,YAAY,CAAGpC,KAAK,CAACqC,IAAI,CAAC,CAAEhF,MAAM,CAAE,EAAG,CAAC,CAAE,CAACiF,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAG,CAAC,CAAC,CAChE,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAnM,KAAK,CAACoM,IAAI,CAAC,eAAe,CAAE,CAAEC,EAAE,CAAEhL,OAAO,CAAE4E,IAAI,CAAEjE,QAAQ,CAAEsK,QAAQ,CAAEP,YAAY,CAAEQ,MAAM,CAAE7I,OAAO,CAAEgF,MAAM,CAAE9E,OAAO,CAAE4I,MAAM,CAAE,CAAEC,KAAK,CAAE3I,MAAM,CAAE4I,IAAI,CAAE1I,KAAK,CAAE2I,OAAO,CAAEzI,OAAO,CAAG,CAAC,CAAG,CAAE,CAAC,CAAE2F,IAAI,CAAEzG,QAAQ,CAAC4G,GAAG,CAACwB,CAAC,GAAK,CAAEpB,CAAC,CAAEwC,MAAM,CAACpB,CAAC,CAACtB,SAAS,CAAC,CAAEI,CAAC,CAAEkB,CAAC,CAACnB,IAAI,CAAEG,CAAC,CAAEgB,CAAC,CAACjB,IAAI,CAAEG,CAAC,CAAEc,CAAC,CAACf,GAAG,CAAEG,CAAC,CAAEY,CAAC,CAACb,KAAK,CAAEG,CAAC,CAAEU,CAAC,CAACX,MAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAEgC,OAAO,CAAE,SAAU,CAAC,CAAC,CAClV,KAAM,CAAAC,KAAK,CAAG,EAAA0C,UAAA,CAAArD,GAAG,CAACtC,IAAI,UAAA2F,UAAA,iBAARA,UAAA,CAAUzC,WAAW,GAAI,CAAC,CAAC,CACzC,KAAM,CAAAC,GAAG,EAAAyC,eAAA,EAAAC,SAAA,CAAGtM,QAAQ,CAACA,QAAQ,CAAC4D,MAAM,CAAG,CAAC,CAAC,UAAA0I,SAAA,iBAA7BA,SAAA,CAA+B/E,KAAK,UAAA8E,eAAA,UAAAA,eAAA,CAAI,IAAI,CACxD,KAAM,CAAAxC,IAAI,CAAIzB,CAAS,OAAAqE,SAAA,QAAAA,SAAA,CAAM/C,KAAK,CAACtB,CAAC,CAAC,UAAAqE,SAAA,UAAAA,SAAA,CAAI/C,KAAK,CAACF,MAAM,CAACpB,CAAC,CAAC,CAAC,EAAC,CAC1D,KAAM,CAAA2B,KAAK,CAAI3B,CAAS,EAAK,CAC3B,KAAM,CAAAvB,CAAC,CAAGgD,IAAI,CAACzB,CAAC,CAAC,CACjB,GAAIvB,CAAC,EAAI,IAAI,EAAI+C,GAAG,EAAI,IAAI,CAAE,MAAO,CAAAI,SAAS,CAC9C,KAAM,CAAAC,GAAG,CAAGL,GAAG,CAAI,CAAC/C,CAAC,CAAG+C,GAAG,EAAIA,GAAG,CAAI,GAAG,CAAG,CAAC,CAC7C,MAAO,CAAEM,KAAK,CAAErD,CAAC,CAAEoD,GAAI,CAAC,CAC1B,CAAC,CACD,KAAM,CAAAE,YAA4D,CAAG,CAAC,CAAC,CACvE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAACC,OAAO,CAAEhC,CAAC,EAAK,CAAE,KAAM,CAAAV,CAAC,CAAGqC,KAAK,CAAC3B,CAAC,CAAC,CAAE,GAAIV,CAAC,CAAEyC,YAAY,CAAC/B,CAAC,CAAC,CAAGV,CAAC,CAAE,CAAC,CAAC,CAC7EvH,WAAW,CAAC,CAAEkK,EAAE,CAAEF,YAAY,CAAC,CAAC,CAAC,CAAEG,GAAG,CAAEH,YAAY,CAAC,EAAE,CAAC,CAAEI,GAAG,CAAEJ,YAAY,CAAC,EAAE,CAAE,CAAC,CAAC,CAClF,GAAI,CAAAK,QAAuB,CAAG,IAAI,CAClC,GAAI,CAAAC,cAA6B,CAAG,IAAI,CACxC,GAAI,CAAAC,WAA0B,CAAG,IAAI,CACrC,GAAI,CAAAC,MAAqB,CAAG,IAAI,CAChC,GAAI,CAAAC,QAAuB,CAAG,IAAI,CAClC,KAAM,CAAAC,OAAO,CAAG7J,UAAU,CAAGE,QAAQ,CACrC,KAAM,CAAA4J,KAA+D,CAAG,EAAE,CAC1E,GAAIlB,GAAG,EAAI,IAAI,CAAE,CACf,IAAK,KAAM,CAAAxB,CAAC,GAAI,CAAAO,YAAY,CAAE,CAC5B,KAAM,CAAA9B,CAAC,CAAGgD,IAAI,CAACzB,CAAC,CAAC,CACjB,GAAI,MAAO,CAAAvB,CAAC,GAAK,QAAQ,CAAE,CACzB,GAAI+D,QAAQ,EAAI,IAAI,EAAI/D,CAAC,CAAG+D,QAAQ,CAAE,CAAEA,QAAQ,CAAG/D,CAAC,CAAE8D,MAAM,CAAGvC,CAAC,CAAE,CAClE,KAAM,CAAA6B,GAAG,CAAI,CAACpD,CAAC,CAAG+C,GAAG,EAAIA,GAAG,CAAI,GAAG,CACnC,KAAM,CAAAmB,GAAG,CAAGd,GAAG,CAAI/I,QAAS,CAC5B,KAAM,CAAA8J,GAAG,CAAGf,GAAG,EAAIY,OAAO,CAC1BC,KAAK,CAACG,IAAI,CAAC,CAAEC,GAAG,CAAE9C,CAAC,CAAE6B,GAAG,CAAEkB,MAAM,CAAEJ,GAAG,CAAEC,GAAI,CAAC,CAAC,CAC7C,GAAIR,QAAQ,EAAI,IAAI,EAAIP,GAAG,EAAIY,OAAO,CAAE,CACtCL,QAAQ,CAAGpC,CAAC,CAAEqC,cAAc,CAAG5D,CAAC,CAAE6D,WAAW,CAAGT,GAAG,CACrD,CACF,CACF,CACF,CACA5I,qBAAqB,CAACmJ,QAAQ,CAAC,CAC/BjJ,uBAAuB,CAACkJ,cAAc,CAAC,CACvChJ,oBAAoB,CAACiJ,WAAW,CAAC,CACjC/I,eAAe,CAACgJ,MAAM,CAAC,CACvB,GAAIjL,MAAM,EAAIiL,MAAM,EAAI,IAAI,CAAE,CAC5B,KAAM,CAAAS,EAAE,CAAG,GAAI,CAAAC,IAAI,CAACtE,MAAM,CAACrH,MAAM,CAAC,CAAGiL,MAAM,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CAClE9I,gBAAgB,CAACuJ,EAAE,CAACE,kBAAkB,CAAC,CAAC,CAAC,CAC3C,CAAC,IAAM,CACLzJ,gBAAgB,CAAC,EAAE,CAAC,CACtB,CACAE,iBAAiB,EAAAwK,UAAA,CAAC3B,QAAQ,UAAA2B,UAAA,UAAAA,UAAA,CAAI,IAAI,CAAC,CACnCtK,QAAQ,CAAC6I,KAAK,CAAC,CAEfzM,gBAAgB,EAAIA,gBAAgB,CAAC,CACnCkN,YAAY,CAAE3B,GAAG,CACjB4B,SAAS,CAAErB,YAAY,CACvB;AACAsB,UAAU,CAAEZ,OAAO,CACnB;AACAa,MAAM,CAAE5K,OAAO,CACfM,kBAAkB,CAAEoJ,QAAQ,CAC5BlJ,oBAAoB,CAAEmJ,cAAc,CACpCjJ,iBAAiB,CAAEkJ,WAAW,CAC9BhJ,YAAY,CAAEiJ,MAAM,CACpB7I,cAAc,EAAA0K,UAAA,CAAE5B,QAAQ,UAAA4B,UAAA,UAAAA,UAAA,CAAI,IAC9B,CAAC,CAAC,CACJ,CAAE,MAAAE,QAAA,CAAM,CAAC,CACT,GAAI,KAAAC,UAAA,CACF,KAAM,CAAAhE,YAAY,CAAGpC,KAAK,CAACqC,IAAI,CAAC,CAAEhF,MAAM,CAAE,EAAG,CAAC,CAAE,CAACiF,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAG,CAAC,CAAC,CAChE,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAnM,KAAK,CAACoM,IAAI,CAAC,oBAAoB,CAAE,CAAEC,EAAE,CAAEhL,OAAO,CAAE4E,IAAI,CAAEjE,QAAQ,CAAEsK,QAAQ,CAAEP,YAAY,CAAEQ,MAAM,CAAE7I,OAAO,CAAEgF,MAAM,CAAE9E,OAAO,CAAEqL,IAAI,CAAE,CAAC,CAAEzC,MAAM,CAAE,CAAEC,KAAK,CAAE3I,MAAM,CAAE4I,IAAI,CAAE1I,KAAK,CAAE2I,OAAO,CAAEzI,OAAO,CAAG,CAAC,CAAG,CAAE,CAAC,CAAE2F,IAAI,CAAEzG,QAAQ,CAAC4G,GAAG,CAACwB,CAAC,GAAK,CAAEpB,CAAC,CAAEwC,MAAM,CAACpB,CAAC,CAACtB,SAAS,CAAC,CAAEI,CAAC,CAAEkB,CAAC,CAACnB,IAAI,CAAEG,CAAC,CAAEgB,CAAC,CAACjB,IAAI,CAAEG,CAAC,CAAEc,CAAC,CAACf,GAAG,CAAEG,CAAC,CAAEY,CAAC,CAACb,KAAK,CAAEG,CAAC,CAAEU,CAAC,CAACX,MAAO,CAAC,CAAC,CAAE,CAAC,CAAE,CAAEgC,OAAO,CAAE,SAAU,CAAC,CAAC,CAChWpJ,YAAY,CAAC,EAAAsM,UAAA,CAAA5D,GAAG,CAACtC,IAAI,UAAAkG,UAAA,iBAARA,UAAA,CAAUb,OAAO,GAAI,IAAI,CAAC,CACzC,CAAE,MAAAc,QAAA,CAAM,CAAC,CACX,CAAC,CACDT,GAAG,CAAC,CAAC,CACL;AACF,CAAC,CAAE,CAAC7L,OAAO,CAAEE,OAAO,CAAEE,MAAM,CAAEE,KAAK,CAAC,CAAC,CAErC;AACAtE,SAAS,CAAC,IAAM,CACd,GAAI2B,OAAO,EAAIM,aAAa,CAAC2D,OAAO,CAAE,CACpC6D,aAAa,CAACnH,QAAQ,CAAC,CACzB,CACA;AACF,CAAC,CAAE,CAACR,YAAY,CAAC,CAAC,CAElB,KAAM,CAAAyO,oBAAoB,CAAIC,WAA2B,EAAK,CAC5DjO,WAAW,CAACiO,WAAW,CAAC,CACxB,GAAI3O,gBAAgB,CAAE,CACpBA,gBAAgB,CAAC2O,WAAW,CAAC,CAC/B,CACF,CAAC,CAED;AACA,KAAM,CAAAC,SAAS,CAAGjO,SAAS,EAAI,IAAI,EAAIE,SAAS,EAAI,IAAI,CAAGF,SAAS,CAAGE,SAAS,CAAG,IAAI,CACvF,KAAM,CAAAgO,SAAS,CAAGD,SAAS,EAAI,IAAI,EAAI/N,SAAS,CAAI+N,SAAS,CAAG/N,SAAS,CAAI,GAAG,CAAG,IAAI,CACvF,KAAM,CAAAiO,EAAE,CAAG,CAACF,SAAS,SAATA,SAAS,UAATA,SAAS,CAAI,CAAC,EAAI,CAAC,CAC/B,KAAM,CAAAG,IAAI,CAAG,CAACH,SAAS,SAATA,SAAS,UAATA,SAAS,CAAI,CAAC,EAAI,CAAC,CACjC,KAAM,CAAAI,SAAS,CAAG,QAAAA,CAACC,CAAgB,KAAE,CAAAC,MAAM,CAAAC,SAAA,CAAA1J,MAAA,IAAA0J,SAAA,MAAAtD,SAAA,CAAAsD,SAAA,IAAG,CAAC,OAAM,CAAAF,CAAC,EAAI,IAAI,CAAG,IAAI,CAAGA,CAAC,CAACG,OAAO,CAACF,MAAM,CAAC,EAAC,CAC1F,KAAM,CAAAG,QAAQ,CAAIC,EAAiB,EAAMA,EAAE,EAAI,IAAI,CAAG,EAAE,CAAG,GAAI,CAAApC,IAAI,CAACoC,EAAE,CAAC,CAACC,cAAc,CAAC,CAAE,CAEzF;AACA,KAAM,CAAAC,mBAAmB,CAAGA,CAAA,GAAM,CAChC,GAAI,CAACpP,aAAa,CAAC2D,OAAO,CAAE,OAC5B,KAAM,CAAA0L,KAAK,CAAG,CAAC,IAAI,CAAE,MAAM,CAAE,MAAM,CAAE,KAAK,CAAC,CAC3C,IAAK,KAAM,CAAAC,IAAI,GAAI,CAAAD,KAAK,CAAE,CACxB;AACA;AACA,OAAAE,sBAAA,CAAO,CAAAC,sBAAA,CAAAxP,aAAa,CAAC2D,OAAO,EAAC8L,eAAe,UAAAF,sBAAA,WAArCA,sBAAA,CAAAnI,IAAA,CAAAoI,sBAAA,CAAwC,CAAEF,IAAK,CAAC,CAAC,CAAE,KAAAC,sBAAA,CAAAC,sBAAA,CAE1D,CADE;AAEJ,CACF,CAAC,CAED,KAAM,CAAAE,mBAAmB,CAAIC,GAAW,EAAK,KAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,sBAAA,CAAAC,uBAAA,CAC3C,GAAI,CAACjQ,aAAa,CAAC2D,OAAO,CAAE,OAC5ByL,mBAAmB,CAAC,CAAC,CACrB,GAAI,CACF,OAAQO,GAAG,EACT,IAAK,IAAI,CACP,CAAAC,sBAAA,EAAAC,sBAAA,CAAA7P,aAAa,CAAC2D,OAAO,EAACuM,iBAAiB,UAAAN,sBAAA,iBAAvCA,sBAAA,CAAAxI,IAAA,CAAAyI,sBAAA,CAA0C,CAAEP,IAAI,CAAE,IAAI,CAAEa,UAAU,CAAE,CAAC,CAAC,CAAE,EAAE,CAAE,EAAE,CAAE,CAAQ,CAAC,CACzFnQ,aAAa,CAAC2D,OAAO,CAACyM,eAAe,CAAC,IAAI,CAAE,KAAK,CAAC,CAClD,MACF,IAAK,MAAM,CACTpQ,aAAa,CAAC2D,OAAO,CAACyM,eAAe,CAAC,MAAM,CAAE,KAAY,CAAC,CAC3D,MACF,IAAK,MAAM,CACT,CAAAN,sBAAA,EAAAC,sBAAA,CAAA/P,aAAa,CAAC2D,OAAO,EAACuM,iBAAiB,UAAAJ,sBAAA,iBAAvCA,sBAAA,CAAA1I,IAAA,CAAA2I,sBAAA,CAA0C,CAAET,IAAI,CAAE,MAAM,CAAEa,UAAU,CAAE,CAAC,EAAE,CAAE,EAAE,CAAE,CAAC,CAAE,CAAQ,CAAC,CAC3FnQ,aAAa,CAAC2D,OAAO,CAACyM,eAAe,CAAC,MAAM,CAAE,KAAK,CAAE,CAAEzQ,MAAM,CAAE,GAAI,CAAQ,CAAC,CAC5E,MACF,IAAK,KAAK,CACR,CAAAqQ,sBAAA,EAAAC,uBAAA,CAAAjQ,aAAa,CAAC2D,OAAO,EAACuM,iBAAiB,UAAAF,sBAAA,iBAAvCA,sBAAA,CAAA5I,IAAA,CAAA6I,uBAAA,CAA0C,CAAEX,IAAI,CAAE,KAAK,CAAEa,UAAU,CAAE,CAAC,CAAC,CAAE,EAAE,CAAE,CAAQ,CAAC,CACtFnQ,aAAa,CAAC2D,OAAO,CAACyM,eAAe,CAAC,KAAK,CAAE,KAAK,CAAE,CAAEzQ,MAAM,CAAE,EAAG,CAAQ,CAAC,CAC1E,MACF,QACE,MACJ,CACF,CAAE,MAAA0Q,QAAA,CAAM,CAAC,CACX,CAAC,CAEDtS,SAAS,CAAC,IAAM,CACd2R,mBAAmB,CAACnO,SAAS,CAAC,CAC9B;AACF,CAAC,CAAE,CAACA,SAAS,CAAEvB,aAAa,CAAC2D,OAAO,CAAC,CAAC,CAGtC,mBACEvE,KAAA,QAAK4E,KAAK,CAAE,CAAEsM,QAAQ,CAAE,UAAW,CAAE,CAAAC,QAAA,eACnCnR,KAAA,QAAK4E,KAAK,CAAE,CACVwM,YAAY,CAAE,EAAE,CAChBC,OAAO,CAAE,MAAM,CACfC,cAAc,CAAE,eAAe,CAC/BC,UAAU,CAAE,QACd,CAAE,CAAAJ,QAAA,eACAnR,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,EAAG,CAAC2M,IAAI,MAAAL,QAAA,eACnBrR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAC7M,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,oBAAAO,MAAA,CAAWpR,OAAO,EAAS,CAAC,cACrER,IAAA,CAACZ,SAAS,EACR2F,IAAI,CAAC,OAAO,CACZ8M,KAAK,CAAE1Q,QAAS,CAChB2Q,OAAO,CAAE,CACP,CAAEC,KAAK,CAAE,KAAK,CAAEF,KAAK,CAAE,OAAQ,CAAC,CAChC,CAAEE,KAAK,CAAE,KAAK,CAAEF,KAAK,CAAE,OAAQ,CAAC,CAChC,CAAEE,KAAK,CAAE,IAAI,CAAEF,KAAK,CAAE,MAAO,CAAC,CAC9B,CAAEE,KAAK,CAAE,IAAI,CAAEF,KAAK,CAAE,MAAO,CAAC,CAC9B,CACFG,QAAQ,CAAGC,GAAG,EAAK7C,oBAAoB,CAAC6C,GAAqB,CAAE,CAChE,CAAC,EACG,CAAC,cACR/R,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,EAAG,CAAC2M,IAAI,MAAAL,QAAA,EAClBhQ,SAAS,EAAI,IAAI,eAChBnB,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAEwK,EAAE,CAAG,SAAS,CAAGC,IAAI,CAAG,SAAS,CAAG,SAAS,CAAEyC,UAAU,CAAE,GAAI,CAAE,CAAAb,QAAA,EACpF3B,SAAS,CAACrO,SAAS,CAAC,CAAC,GAAC,CAACiO,SAAS,EAAI,IAAI,EAAIC,SAAS,EAAI,IAAI,EAAK,CAACC,EAAE,CAAG,GAAG,CAAG,EAAE,KAAAoC,MAAA,CAAOlC,SAAS,CAACJ,SAAS,CAAC,OAAAsC,MAAA,CAAKlC,SAAS,CAACH,SAAS,CAAC,MAAK,EACtI,CACP,cACDrP,KAAA,CAACG,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,IAAE,CAAC3B,SAAS,CAACjO,QAAQ,CAAC,EAAO,CAAC,cAClFvB,KAAA,CAACG,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,IAAE,CAAC3B,SAAS,CAAC/N,QAAQ,CAAC,EAAO,CAAC,cAClFzB,KAAA,CAACG,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,IAAE,CAAC3B,SAAS,CAAC7N,OAAO,CAAC,EAAO,CAAC,cACjF3B,KAAA,CAACG,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,IAAE,CAAC3B,SAAS,CAACrO,SAAS,CAAC,EAAO,CAAC,cACnFnB,KAAA,CAACG,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,SAAE,CAAC3B,SAAS,CAAC3N,OAAO,CAAE,CAAC,CAAC,CAAEI,QAAQ,EAAI,IAAI,sBAAAyP,MAAA,CAAclC,SAAS,CAACvN,QAAQ,CAAE,CAAC,CAAC,EAAK,EAAE,EAAO,CAAC,cACjJnC,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAACN,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,CAAEtB,QAAQ,CAAC9N,MAAM,CAAC,CAAO,CAAC,CAE5ElB,OAAO,eAAIf,IAAA,CAACX,IAAI,EAAC0F,IAAI,CAAC,OAAO,CAAE,CAAC,EAC5B,CAAC,EACL,CAAC,cAGN/E,IAAA,QAAK8E,KAAK,CAAE,CAAEqN,SAAS,CAAE,EAAG,CAAE,CAAAd,QAAA,cAC5BrR,IAAA,CAACP,IAAI,EAACsF,IAAI,CAAC,OAAO,CAACqN,QAAQ,MAACtN,KAAK,CAAE,CAAEmC,YAAY,CAAE,CAAE,CAAE,CAAAoK,QAAA,cACrDnR,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,EAAG,CAAC2M,IAAI,MAAAL,QAAA,eACnBnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,qBAAI,CAAM,CAAC,cACxBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACmK,EAAE,cACV1M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACrG3B,SAAS,CAACjN,QAAQ,CAACmK,EAAE,CAACH,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAC,CAAC,IAC9D,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sBAAK,CAAM,CAAC,cACzBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACoK,GAAG,cACX3M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACvG3B,SAAS,CAACjN,QAAQ,CAACoK,GAAG,CAACJ,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAC,CAAC,IAChE,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sBAAK,CAAM,CAAC,cACzBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACqK,GAAG,cACX5M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACvG3B,SAAS,CAACjN,QAAQ,CAACqK,GAAG,CAACL,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAC,CAAC,IAChE,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sCAAM,CAAM,CAAC,cAC1BrR,IAAA,QAAAqR,QAAA,CACG1N,kBAAkB,EAAI,IAAI,cACzBzD,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACEnR,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAE1N,kBAAkB,CAAC,SAAE,EAAM,CAAC,CAC/DE,oBAAoB,EAAI,IAAI,EAAIE,iBAAiB,EAAI,IAAI,eACxD7D,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEuN,UAAU,CAAE,CAAC,CAAErN,KAAK,CAAEjB,iBAAiB,CAAG,CAAC,CAAG,SAAS,CAAGA,iBAAiB,CAAG,CAAC,CAAG,SAAS,CAAG,SAAU,CAAE,CAAAsN,QAAA,EAAC,qBACpH,CAAC3B,SAAS,CAAC7L,oBAAoB,CAAC,CAAC,IAAE,CAAC6L,SAAS,CAAC3L,iBAAiB,CAAC,CAAC,IACvE,EAAM,CACP,EACD,CAAC,cAEH/D,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,cAAE,CAAM,CAChC,CACE,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sCAAM,CAAM,CAAC,cAC1BrR,IAAA,QAAAqR,QAAA,CACGpN,YAAY,EAAI,IAAI,EAAII,cAAc,EAAI,IAAI,cAC7CnE,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,CAAElN,aAAa,KAAAyN,MAAA,CAAO3N,YAAY,iBAAK,CAAO,CAAC,cACjF/D,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEuN,UAAU,CAAE,CAAC,CAAErN,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,qBAAI,CAAC3B,SAAS,CAACrL,cAAc,CAAC,EAAO,CAAC,EACxF,CAAC,cAEHrE,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,cAAE,CAAM,CAChC,CACE,CAAC,EACH,CAAC,EAED,CAAC,CACJ,CAAC,CACJ,CAAC,cAGNrR,IAAA,QAAK8E,KAAK,CAAE,CAAEqN,SAAS,CAAE,EAAG,CAAE,CAAAd,QAAA,cAC5BrR,IAAA,CAACP,IAAI,EAACsF,IAAI,CAAC,OAAO,CAACqN,QAAQ,MAACtN,KAAK,CAAE,CAAEmC,YAAY,CAAE,CAAE,CAAE,CAACqL,KAAK,CAAC,gDAAa,CAAAjB,QAAA,CACxE9M,KAAK,CAAC4B,MAAM,cACXnG,IAAA,CAACH,KAAK,EACJkF,IAAI,CAAC,OAAO,CACZwN,UAAU,CAAE,KAAM,CAClBC,MAAM,CAAGC,CAAK,EAAI1G,MAAM,CAAC0G,CAAC,CAAChF,GAAG,CAAE,CAChCiF,OAAO,CAAE,CACP,CAAEJ,KAAK,CAAE,IAAI,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,EAAG,CAAC,CAC5C,CAAEN,KAAK,CAAE,KAAK,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE5I,CAAQ,KAAA2H,MAAA,CAAOlC,SAAS,CAACzF,CAAC,CAAC,CAAC,CAAC,CAAG,CAAC,CACvF,CAAEqI,KAAK,CAAE,MAAM,CAAEK,SAAS,CAAE,QAAQ,CAAEC,KAAK,CAAE,GAAG,CAAEC,MAAM,CAAE5I,CAAQ,KAAA2H,MAAA,CAAOlC,SAAS,CAACzF,CAAC,CAAC,CAAC,CAAC,CAAG,CAAC,CAC3F,CAAEqI,KAAK,CAAE,IAAI,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,EAAE,CAAEC,MAAM,CAAE5I,CAAS,EAAIA,CAAC,CAAE,GAAG,CAAC,GAAI,CAAC,CACtE,CACT6I,UAAU,CAAEvO,KAAM,CACnB,CAAC,cAEFvE,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,0BAAI,CAAM,CAClC,CACG,CAAC,CACJ,CAAC,cAGNrR,IAAA,QAAK8E,KAAK,CAAE,CAAEqN,SAAS,CAAE,EAAG,CAAE,CAAAd,QAAA,cAC5BrR,IAAA,CAACP,IAAI,EAACsF,IAAI,CAAC,OAAO,CAACqN,QAAQ,MAACtN,KAAK,CAAE,CAAEmC,YAAY,CAAE,CAAE,CAAE,CAACqL,KAAK,CAAC,kEAAgB,CAAAjB,QAAA,CAC3E1O,SAAS,cACR3C,IAAA,CAACH,KAAK,EACJkF,IAAI,CAAC,OAAO,CACZwN,UAAU,CAAE,KAAM,CAClBC,MAAM,CAAGC,CAAM,EAAK1G,MAAM,CAAC0G,CAAC,CAAChF,GAAG,CAAE,CAClCiF,OAAO,CAAE,CACP,CAAEJ,KAAK,CAAE,IAAI,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,EAAG,CAAC,CAC5C,CAAEN,KAAK,CAAE,IAAI,CAAEK,SAAS,CAAE,QAAQ,CAAEC,KAAK,CAAE,EAAG,CAAC,CAC/C,CAAEN,KAAK,CAAE,OAAO,CAAEK,SAAS,CAAE,MAAM,CAAEC,KAAK,CAAE,GAAI,CAAC,CACjD,CAAEN,KAAK,CAAE,KAAK,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,GAAI,CAAC,CAC9C,CAAEN,KAAK,CAAE,MAAM,CAAEK,SAAS,CAAE,MAAM,CAAEC,KAAK,CAAE,GAAI,CAAC,CAChD,CAAEN,KAAK,CAAE,MAAM,CAAEK,SAAS,CAAE,KAAK,CAAEC,KAAK,CAAE,GAAI,CAAC,CACxC,CACTE,UAAU,CAAEhK,KAAK,CAACqC,IAAI,CAAC,CAAEhF,MAAM,CAAE,EAAG,CAAC,CAAE,CAACiF,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAG,CAAC,CAAC,CAAClC,GAAG,CAAEwB,CAAC,EAAK,KAAAoI,SAAA,CACjE,KAAM,CAAAC,CAAC,CAAGjH,MAAM,CAACpB,CAAC,CAAC,CACnB,KAAM,CAAAsI,CAAC,CAAGtQ,SAAS,CAACqQ,CAAC,CAAQ,CAC7B,MAAO,CACLvF,GAAG,CAAE9C,CAAC,CACN9B,MAAM,EAAAkK,SAAA,CAAEE,CAAC,SAADA,CAAC,iBAADA,CAAC,CAAEpK,MAAM,UAAAkK,SAAA,UAAAA,SAAA,CAAI,CAAC,CACtBG,IAAI,CAAED,CAAC,IAAArB,MAAA,CAAMlC,SAAS,CAACuD,CAAC,CAACC,IAAI,CAAE,CAAC,CAAC,EAAK,IAAI,CAC1CC,GAAG,CAAEF,CAAC,IAAArB,MAAA,CAAMlC,SAAS,CAACuD,CAAC,CAACE,GAAG,CAAE,CAAC,CAAC,EAAK,IAAI,CACxCC,IAAI,CAAEH,CAAC,IAAArB,MAAA,CAAMlC,SAAS,CAACuD,CAAC,CAACG,IAAI,CAAE,CAAC,CAAC,EAAK,IAAI,CAC1C7F,GAAG,CAAE0F,CAAC,IAAArB,MAAA,CAAMlC,SAAS,CAACuD,CAAC,CAACI,QAAQ,CAAE,CAAC,CAAC,EAAK,IAC3C,CAAC,CACH,CAAC,CAAE,CACJ,CAAC,cAEFrT,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,qDAAW,CAAM,CACzC,CACG,CAAC,CACJ,CAAC,cAENrR,IAAA,QAAK8E,KAAK,CAAE,CAAEwM,YAAY,CAAE,CAAE,CAAE,CAAAD,QAAA,cAC9BrR,IAAA,CAACR,IAAI,EACHuF,IAAI,CAAC,OAAO,CACZuO,SAAS,CAAEjR,SAAU,CACrB2P,QAAQ,CAAE1P,YAAa,CACvBiR,KAAK,CAAE,CACL,CAAEC,GAAG,CAAE,IAAI,CAAEzB,KAAK,CAAE,OAAQ,CAAC,CAC7B,CAAEyB,GAAG,CAAE,MAAM,CAAEzB,KAAK,CAAE,UAAW,CAAC,CAClC,CAAEyB,GAAG,CAAE,MAAM,CAAEzB,KAAK,CAAE,SAAU,CAAC,CACjC,CAAEyB,GAAG,CAAE,KAAK,CAAEzB,KAAK,CAAE,SAAU,CAAC,CAChC,CACH,CAAC,CACC,CAAC,cAGN/R,IAAA,CAACP,IAAI,EACHsF,IAAI,CAAC,OAAO,CACZD,KAAK,CAAE,CAAEwM,YAAY,CAAE,CAAC,CAAErK,YAAY,CAAE,CAAE,CAAE,CAC5CqL,KAAK,cACHpS,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,CAAE,CAAAsM,QAAA,EAAC,0BAEd,cAAArR,IAAA,CAACJ,OAAO,EACN6T,YAAY,CAAE,CAAEC,QAAQ,CAAE,GAAI,CAAE,CAChCpB,KAAK,cACHpS,KAAA,QAAK4E,KAAK,CAAE,CAAE6O,QAAQ,CAAE,EAAE,CAAEC,UAAU,CAAE,GAAI,CAAE,CAAAvC,QAAA,eAC5CnR,KAAA,QAAAmR,QAAA,eAAKrR,IAAA,MAAAqR,QAAA,CAAG,0BAAI,CAAG,CAAC,+IAAmC,EAAK,CAAC,cACzDnR,KAAA,QAAAmR,QAAA,eAAKrR,IAAA,MAAAqR,QAAA,CAAG,qBAAS,CAAG,CAAC,gHAAwB,EAAK,CAAC,cACnDnR,KAAA,QAAAmR,QAAA,eAAKrR,IAAA,MAAAqR,QAAA,CAAG,4BAAW,CAAG,CAAC,oGAAsB,EAAK,CAAC,cACnDnR,KAAA,QAAAmR,QAAA,eAAKrR,IAAA,MAAAqR,QAAA,CAAG,wBAAO,CAAG,CAAC,+FAAsB,EAAK,CAAC,cAC/CnR,KAAA,QAAAmR,QAAA,eAAKrR,IAAA,MAAAqR,QAAA,CAAG,mBAAO,CAAG,CAAC,6GAAqB,EAAK,CAAC,cAC9CrR,IAAA,QAAK8E,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,CAAC,0HAAoB,CAAK,CAAC,EACzD,CACN,CAAAA,QAAA,cAEDrR,IAAA,CAACF,sBAAsB,EAACgF,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAE,CAAC,CAChD,CAAC,EACL,CACR,CAAAqM,QAAA,cAEDnR,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,EAAG,CAAC2M,IAAI,MAAAL,QAAA,eACnBrR,IAAA,SAAAqR,QAAA,CAAM,cAAE,CAAM,CAAC,cACfrR,IAAA,CAACZ,SAAS,EACR2F,IAAI,CAAC,OAAO,CACZ8M,KAAK,CAAEhP,OAAQ,CACfmP,QAAQ,CAAG/H,CAAC,EAAKnH,UAAU,CAACmH,CAAQ,CAAE,CACtC6H,OAAO,CAAE,CAAC,CAAEC,KAAK,CAAE,MAAM,CAAEF,KAAK,CAAE,QAAS,CAAC,CAAE,CAAEE,KAAK,CAAE,KAAK,CAAEF,KAAK,CAAE,KAAM,CAAC,CAAE,CAAEE,KAAK,CAAE,MAAM,CAAEF,KAAK,CAAE,MAAO,CAAC,CAAE,CACjH,CAAC,cAEF7R,IAAA,SAAAqR,QAAA,CAAM,cAAE,CAAM,CAAC,cACfrR,IAAA,CAACL,MAAM,EAACoF,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAE9O,OAAQ,CAACiP,QAAQ,CAAEhP,UAAW,CAAC8B,KAAK,CAAE,CAAE8N,KAAK,CAAE,GAAI,CAAE,CAC/Ed,OAAO,CAAE,CAAC,CAAED,KAAK,CAAE,EAAE,CAAEE,KAAK,CAAE,IAAK,CAAC,CAAE,CAAEF,KAAK,CAAE,GAAG,CAAEE,KAAK,CAAE,KAAM,CAAC,CAAE,CAAEF,KAAK,CAAE,GAAG,CAAEE,KAAK,CAAE,KAAM,CAAC,CAAE,CAAEF,KAAK,CAAE,GAAG,CAAEE,KAAK,CAAE,KAAM,CAAC,CAAE,CAAE,CAAC,CAEpI,CAAClP,OAAO,GAAK,KAAK,EAAIA,OAAO,GAAK,MAAM,gBACvC3C,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACErR,IAAA,SAAAqR,QAAA,CAAM,QAAC,CAAM,CAAC,cACdrR,IAAA,CAACN,WAAW,EAACqF,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAE5O,MAAO,CAAC4Q,GAAG,CAAE,IAAK,CAACrJ,GAAG,CAAE,IAAK,CAAC4D,IAAI,CAAE,IAAK,CAAC4D,QAAQ,CAAG/H,CAAC,EAAK/G,SAAS,CAACoG,MAAM,CAACW,CAAC,CAAC,CAAE,CAAE,CAAC,EACpH,CACH,CACApH,OAAO,GAAK,MAAM,eACjB3C,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACErR,IAAA,SAAAqR,QAAA,CAAM,QAAC,CAAM,CAAC,cACdrR,IAAA,CAACN,WAAW,EAACqF,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAE1O,KAAM,CAAC0Q,GAAG,CAAE,GAAI,CAACrJ,GAAG,CAAE,IAAK,CAAC4D,IAAI,CAAE,IAAK,CAAC4D,QAAQ,CAAG/H,CAAC,EAAK7G,QAAQ,CAACkG,MAAM,CAACW,CAAC,CAAC,CAAE,CAAE,CAAC,EACjH,CACH,cAEDjK,IAAA,SAAAqR,QAAA,CAAM,0BAAI,CAAM,CAAC,cACjBrR,IAAA,CAACZ,SAAS,EAAC2F,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAExO,OAAO,CAAG,IAAI,CAAG,KAAM,CAAC2O,QAAQ,CAAG/H,CAAC,EAAI3G,UAAU,CAAC2G,CAAC,GAAK,IAAI,CAAE,CAAC6H,OAAO,CAAE,CAAC,CAACC,KAAK,CAAC,GAAG,CAACF,KAAK,CAAC,IAAI,CAAC,CAAC,CAACE,KAAK,CAAC,GAAG,CAACF,KAAK,CAAC,KAAK,CAAC,CAAE,CAAE,CAAC,cAE5J7R,IAAA,SAAAqR,QAAA,CAAM,2BAAK,CAAM,CAAC,cAClBrR,IAAA,CAACN,WAAW,EAACqF,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAEtO,UAAW,CAAC6K,IAAI,CAAE,GAAI,CAAC4D,QAAQ,CAAG/H,CAAC,EAAIzG,aAAa,CAAC8F,MAAM,CAACW,CAAC,CAAC,CAAE,CAAE,CAAC,cACpGjK,IAAA,SAAAqR,QAAA,CAAM,eAAG,CAAM,CAAC,cAChBrR,IAAA,CAACN,WAAW,EAACqF,IAAI,CAAC,OAAO,CAAC8M,KAAK,CAAEpO,QAAS,CAAC2K,IAAI,CAAE,GAAI,CAAC4D,QAAQ,CAAG/H,CAAC,EAAIvG,WAAW,CAAC4F,MAAM,CAACW,CAAC,CAAC,CAAE,CAAE,CAAC,EAC3F,CAAC,CACJ,CAAC,cAEPjK,IAAA,QACE8T,GAAG,CAAEjT,QAAS,CACdiE,KAAK,CAAE,CACL8N,KAAK,CAAE,MAAM,CACbnS,MAAM,IAAAmR,MAAA,CAAKnR,MAAM,MAAI,CACrByG,eAAe,CAAE,SAAS,CAC1BD,YAAY,CAAE,CAAC,CACf8M,MAAM,CAAE,mBAAmB,CAC3B3C,QAAQ,CAAE,UACZ,CAAE,CACH,CAAC,cAGFpR,IAAA,QAAK8E,KAAK,CAAE,CAAEqN,SAAS,CAAE,EAAG,CAAE,CAAAd,QAAA,cAC5BrR,IAAA,CAACP,IAAI,EAACsF,IAAI,CAAC,OAAO,CAACqN,QAAQ,MAACtN,KAAK,CAAE,CAAEmC,YAAY,CAAE,CAAE,CAAE,CAAAoK,QAAA,cACrDnR,KAAA,CAACX,KAAK,EAACwF,IAAI,CAAE,EAAG,CAAC2M,IAAI,MAAAL,QAAA,eACnBnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,qBAAI,CAAM,CAAC,cACxBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACmK,EAAE,cACV1M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACrG3B,SAAS,CAACjN,QAAQ,CAACmK,EAAE,CAACH,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACmK,EAAE,CAACJ,GAAG,CAAC,CAAC,IAC9D,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sBAAK,CAAM,CAAC,cACzBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACoK,GAAG,cACX3M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACvG3B,SAAS,CAACjN,QAAQ,CAACoK,GAAG,CAACJ,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACoK,GAAG,CAACL,GAAG,CAAC,CAAC,IAChE,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sBAAK,CAAM,CAAC,cACzBrR,IAAA,QAAAqR,QAAA,CACG5O,QAAQ,CAACqK,GAAG,cACX5M,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAGvC,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG/J,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAG,CAAC,CAAG,SAAS,CAAG,SAAW,CAAE,CAAA6E,QAAA,EACvG3B,SAAS,CAACjN,QAAQ,CAACqK,GAAG,CAACL,KAAK,CAAC,CAAC,IAAE,CAACiD,SAAS,CAACjN,QAAQ,CAACqK,GAAG,CAACN,GAAG,CAAC,CAAC,IAChE,EAAM,CAAC,cACLxM,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,QAAC,CAAM,CAAC,CAChC,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sCAAM,CAAM,CAAC,cAC1BrR,IAAA,QAAAqR,QAAA,CACG1N,kBAAkB,EAAI,IAAI,cACzBzD,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACEnR,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAE1N,kBAAkB,CAAC,SAAE,EAAM,CAAC,CAC/DE,oBAAoB,EAAI,IAAI,EAAIE,iBAAiB,EAAI,IAAI,eACxD7D,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEuN,UAAU,CAAE,CAAC,CAAErN,KAAK,CAAEjB,iBAAiB,CAAG,CAAC,CAAG,SAAS,CAAGA,iBAAiB,CAAG,CAAC,CAAG,SAAS,CAAG,SAAU,CAAE,CAAAsN,QAAA,EAAC,qBACpH,CAAC3B,SAAS,CAAC7L,oBAAoB,CAAC,CAAC,IAAE,CAAC6L,SAAS,CAAC3L,iBAAiB,CAAC,CAAC,IACvE,EAAM,CACP,EACD,CAAC,cAEH/D,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,cAAE,CAAM,CAChC,CACE,CAAC,EACH,CAAC,cACNnR,KAAA,QAAAmR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACsR,MAAM,MAAAN,QAAA,CAAC,sCAAM,CAAM,CAAC,cAC1BrR,IAAA,QAAAqR,QAAA,CACGpN,YAAY,EAAI,IAAI,EAAII,cAAc,EAAI,IAAI,cAC7CnE,KAAA,CAAAE,SAAA,EAAAiR,QAAA,eACErR,IAAA,CAACK,IAAI,EAACyE,KAAK,CAAE,CAAEE,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,CAAElN,aAAa,KAAAyN,MAAA,CAAO3N,YAAY,iBAAK,CAAO,CAAC,cACjF/D,KAAA,CAACG,IAAI,EAACyE,KAAK,CAAE,CAAEuN,UAAU,CAAE,CAAC,CAAErN,KAAK,CAAE,SAAU,CAAE,CAAAqM,QAAA,EAAC,qBAAI,CAAC3B,SAAS,CAACrL,cAAc,CAAC,EAAO,CAAC,EACxF,CAAC,cAEHrE,IAAA,CAACK,IAAI,EAAC+E,IAAI,CAAC,WAAW,CAAAiM,QAAA,CAAC,cAAE,CAAM,CAChC,CACE,CAAC,EACH,CAAC,EAED,CAAC,CACJ,CAAC,CACJ,CAAC,CAILtQ,OAAO,eACNf,IAAA,QACE8E,KAAK,CAAE,CACLsM,QAAQ,CAAE,UAAU,CACpB4C,GAAG,CAAE,KAAK,CACVC,IAAI,CAAE,KAAK,CACXC,SAAS,CAAE,uBAAuB,CAClChN,eAAe,CAAE,oBAAoB,CACrCD,YAAY,CAAE,KAAK,CACnBkN,OAAO,CAAE,MAAM,CACfC,MAAM,CAAE,IACV,CAAE,CAAA/C,QAAA,cAEFrR,IAAA,CAACX,IAAI,EAAC0F,IAAI,CAAC,OAAO,CAAE,CAAC,CAClB,CACN,EACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAAzE,UAAU","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}